12:51:52.716   INFO  infrastructure starting
12:51:52.779  TRACE  Waiting for an infrastructure initialization message.
12:51:52.867  DEBUG  Initiating infrastructure provisioning.
12:51:53.152  TRACE  Run for execution "C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils\descriptionsService\AI.Descriptions.HostedService.exe" in job "job-b8323ed6-2901-4527-b37a-3ff43d180b6c". Start parameters: " --port 5008 --feed-folder "C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\feeds" --log-path "C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Logs\Infrastructure\2024-11-15-12-51-52\descriptionsService.log " --log-level Trace".
12:51:53.152  TRACE  Process successful started with pid 14008.
12:51:53.152  TRACE  Waiting for exit of process with pid 14008.
12:51:53.171  TRACE  update feeds started
12:51:53.171  TRACE  Attempt send update feeds request to service
12:51:53.227   INFO  There are 1 suitable migrations
12:51:53.227  DEBUG  Version '2.3.1' with 2 stage(s)
12:51:53.227   INFO  Migration to '2.3.1' version start
12:51:53.227   INFO  Migration to '2.3.1' version success complete
12:51:53.352  TRACE  Send message {Initialized, 5ed23348-7eac-984d-815a-9126baac8a47, Json, 7 bytes}.
12:51:53.377   INFO  Wait transport disconnecting
12:51:53.377  TRACE  Receive message {Initialize, 5ed23348-7eac-984d-815a-9126baac8a47, Json, 1144 bytes}.
12:51:53.552  TRACE  Send message {IssueDescriptions, c33a3006-2fe9-4743-af23-c6090c148f6d, Json, 1186979 bytes}.
12:51:53.567  TRACE  Receive message {GetIssueDescriptions, c33a3006-2fe9-4743-af23-c6090c148f6d, Json, 0 bytes}.
12:51:54.389  TRACE  Send message {Projects, 924e6f32-a8de-6743-8e54-34c66ee8787b, Json, 244 bytes}.
12:51:54.404  TRACE  Receive message {GetProjects, 924e6f32-a8de-6743-8e54-34c66ee8787b, Json, 0 bytes}.
12:51:54.493  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:51:54.493  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0012722

12:51:54.493  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:51:54.493  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0046379

12:51:54.517  TRACE  Total Execution Time (Completed) (async): 00:00:00.0183339. Rows Count: 2.

12:51:54.517  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:51:54.517  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004909

12:51:54.527  TRACE  Total Execution Time (Completed) (async): 00:00:00.0092934. Rows Count: 5.

12:51:54.527  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

12:51:54.527  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007083

12:51:54.527  TRACE  Total Execution Time (Completed) (async): 00:00:00.0082262. Rows Count: 0.

12:51:54.527  TRACE  BeforeExecute
DisposeTransactionAsync
12:51:54.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006515

12:51:54.540  DEBUG  Scan result ID: 4353f4d2-4659-4046-80d0-96152006c012
12:51:54.540  TRACE  Send message {ScanResult, f1bfde44-81c7-1449-be73-df69541e0845, Json, 1265 bytes}.
12:51:54.562  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:51:54.562  TRACE  Query Execution Time (AfterExecute): 00:00:00.0005362

12:51:54.562  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

12:51:54.562  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003464

12:51:54.562  TRACE  Total Execution Time (Completed): 00:00:00.0026727. Rows Count: 3.

12:51:54.562  TRACE  BeforeExecute
DisposeTransaction
12:51:54.562  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002956

12:51:54.562  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

12:51:54.562  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004142

12:51:54.571  TRACE  Total Execution Time (Completed): 00:00:00.0043336. Rows Count: 1.

12:51:54.571  TRACE  Send message {AssistantNotification, 1142df28-27ae-496b-9e56-033d78ec4e57, Json, 171 bytes}.
12:51:54.571  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:51:54.571  TRACE  Query Execution Time (AfterExecute): 00:00:00.0005766

12:51:54.571  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

12:51:54.571  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003360

12:51:54.571  TRACE  Total Execution Time (Completed): 00:00:00.0006758. Rows Count: 3.

12:51:54.571  TRACE  BeforeExecute
DisposeTransaction
12:51:54.571  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002616

12:51:54.571  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

12:51:54.571  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003270

12:51:54.571  TRACE  Total Execution Time (Completed): 00:00:00.0005700. Rows Count: 1.

12:51:54.596  TRACE  Send message {AssistantNotification, 2aebe65c-d0a0-4274-a117-e23dfc552ce0, Json, 202 bytes}.
12:51:54.596  TRACE  Receive message {GetLastScanResult, f1bfde44-81c7-1449-be73-df69541e0845, Json, 38 bytes}.
12:51:54.596  TRACE  Send message {EnterpriseIntegrationInfo, 77df29e4-6a0c-2545-a28a-33739b69537b, Json, 69 bytes}.
12:51:54.596  TRACE  Receive message {EnterpriseGetState, 77df29e4-6a0c-2545-a28a-33739b69537b, Json, 0 bytes}.
12:51:54.615  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:51:54.615  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004819

12:51:54.615  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_VfsEntity].[Id],
	[detail].[VfsId],
	[detail].[NodePath],
	[detail].[PhysicalPath],
	[detail].[MaxIssueLevel],
	[detail].[ScanByCores],
	[detail].[ScanningByCores],
	[detail].[ScannedByCores],
	[detail].[NodeType],
	[detail].[IncludeInScan],
	[detail].[LifeTimeStatus],
	[detail].[LastModifiedDate],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[Id]
		FROM
			(
				SELECT
					[x].[Id]
				FROM
					[VfsEntity] [x]
				WHERE
					[x].[ScanResultId] = @id
				LIMIT @take
			) [t1]
	) [lw_VfsEntity]
		INNER JOIN [VfsNodeEntity] [detail] ON [lw_VfsEntity].[Id] = [detail].[VfsId]

12:51:54.615  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004928

12:51:54.620  TRACE  Total Execution Time (Completed) (async): 00:00:00.0043415. Rows Count: 14.

12:51:54.620  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[RootNodePath]
FROM
	[VfsEntity] [x]
WHERE
	[x].[ScanResultId] = @id
LIMIT @take

12:51:54.620  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002861

12:51:54.620  TRACE  Total Execution Time (Completed) (async): 00:00:00.0015986. Rows Count: 0.

12:51:54.620  TRACE  BeforeExecute
DisposeTransactionAsync
12:51:54.620  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002288

12:51:54.645  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:51:54.645  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004840

12:51:54.645  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:51:54.645  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004121

12:51:54.645  TRACE  Total Execution Time (Completed) (async): 00:00:00.0017007. Rows Count: 2.

12:51:54.645  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:51:54.645  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002884

12:51:54.645  TRACE  Total Execution Time (Completed) (async): 00:00:00.0013868. Rows Count: 5.

12:51:54.650  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

12:51:54.650  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003916

12:51:54.650  TRACE  Total Execution Time (Completed) (async): 00:00:00.0047311. Rows Count: 1.

12:51:54.650  TRACE  BeforeExecute
DisposeTransactionAsync
12:51:54.650  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002422

12:51:54.650  TRACE  Send message {ScanResultVFS, e6cbacbd-6015-c34f-a060-3e692257b082, Json, 4632 bytes}.
12:51:54.650  TRACE  Receive message {GetScanResultVFS, e6cbacbd-6015-c34f-a060-3e692257b082, Json, 106 bytes}.
12:51:54.650  TRACE  Send message {EnterpriseIntegrationInfo, 46bc8f3f-ad06-5f44-ba2c-ee723949cad5, Json, 69 bytes}.
12:51:54.669  TRACE  Receive message {TryInitializeEnterpriseIntegration, 46bc8f3f-ad06-5f44-ba2c-ee723949cad5, Json, 0 bytes}.
12:51:54.669  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:51:54.669  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005416

12:51:54.669  TRACE  Total Execution Time (Completed) (async): 00:00:00.0018825. Rows Count: 1.

12:51:54.694  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

12:51:54.694  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0012345

12:51:54.696  TRACE  Total Execution Time (Completed) (async): 00:00:00.0081317. Rows Count: 1.

12:51:54.722  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'D2F453435946464080D096152006C012') OR [x].[ObsoleteInScanResultId] IS NULL))

12:51:54.722  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006736

12:51:54.722  TRACE  Total Execution Time (Completed) (async): 00:00:00.0072009. Rows Count: 7.

12:51:54.802  TRACE  Send message {Issues, 9d368505-edda-ba4e-9597-b531b87ca9ff, Json, 10968 bytes}.
12:51:54.802  TRACE  Receive message {GetIssues, 9d368505-edda-ba4e-9597-b531b87ca9ff, Json, 106 bytes}.
12:51:54.807  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:51:54.807  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005643

12:51:54.807  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [t1]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [t1].[Id] = [a_ScanEnvironment].[ScanResultId]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:51:54.821  TRACE  Query Execution Time (AfterExecute): 00:00:00.0006538

12:51:54.821  TRACE  Total Execution Time (Completed): 00:00:00.0023382. Rows Count: 2.

12:51:54.821  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [t1]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [t1].[Id] = [a_ScanEnvironment].[ScanResultId]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:51:54.821  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004186

12:51:54.821  TRACE  Total Execution Time (Completed): 00:00:00.0019028. Rows Count: 5.

12:51:54.821  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[ScanChainId],
	[t1].[ProjectId],
	[t1].[SettingsId],
	[t1].[Version],
	[t1].[ScanDate],
	[t1].[PreviousScanResultId],
	[t1].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [t1]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [t1].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [t1].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [t1].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]

12:51:54.821  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004784

12:51:54.821  TRACE  Total Execution Time (Completed): 00:00:00.0062106. Rows Count: 1.

12:51:54.821  TRACE  BeforeExecute
DisposeTransactionAsync
12:51:54.821  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004262

12:51:54.821  TRACE  Send message {CleanUpScanResultsDone, f83a4373-5c4e-e748-aad3-8ae7d57dddaa, Json, 7 bytes}.
12:51:54.843  TRACE  Receive message {CleanUpScanResults, f83a4373-5c4e-e748-aad3-8ae7d57dddaa, Json, 77 bytes}.
12:51:54.880  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:51:54.880  TRACE  Query Execution Time (AfterExecute): 00:00:00.0006214

12:51:54.880  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [x]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		WHERE
			[x].[ProjectId] = @id
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:51:54.880  TRACE  Query Execution Time (AfterExecute): 00:00:00.0006489

12:51:54.884  TRACE  Total Execution Time (Completed): 00:00:00.0023834. Rows Count: 2.

12:51:54.884  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [x]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		WHERE
			[x].[ProjectId] = @id
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:51:54.884  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003542

12:51:54.884  TRACE  Total Execution Time (Completed): 00:00:00.0017369. Rows Count: 5.

12:51:54.884  TRACE  BeforeExecute
DisposeTransaction
12:51:54.884  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002349

12:51:54.884  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id

12:51:54.884  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004784

12:51:54.884  TRACE  Total Execution Time (Completed): 00:00:00.0052199. Rows Count: 1.

12:51:54.920  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0

SELECT
	[x].[ScanResultId],
	[x].[Level],
	Sum([x].[Count])
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	[x].[State] <> 2 AND [x].[IsSuppressed] = @isSuppressed
GROUP BY
	[x].[ScanResultId],
	[x].[Level]

12:51:54.920  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007219

12:51:54.920  TRACE  Total Execution Time (Completed) (async): 00:00:00.0024891. Rows Count: 3.

12:51:54.920  TRACE  Send message {ScanResults, 7ea6115b-78e7-a142-a574-201d20289444, Json, 1268 bytes}.
12:51:54.938  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:51:54.938  TRACE  Query Execution Time (AfterExecute): 00:00:00.0006710

12:51:54.938  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

12:51:54.938  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002850

12:51:54.938  TRACE  Total Execution Time (Completed): 00:00:00.0005293. Rows Count: 3.

12:51:54.938  TRACE  BeforeExecute
DisposeTransaction
12:51:54.938  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002024

12:51:54.938  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

12:51:54.938  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002660

12:51:54.938  TRACE  Total Execution Time (Completed): 00:00:00.0004736. Rows Count: 1.

12:51:54.938  TRACE  Send message {AssistantNotification, e98d051d-20ca-4337-9d73-d809c9a35351, Json, 171 bytes}.
12:51:54.954  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:51:54.954  TRACE  Query Execution Time (AfterExecute): 00:00:00.0006080

12:51:54.954  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

12:51:54.954  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002885

12:51:54.954  TRACE  Total Execution Time (Completed): 00:00:00.0005243. Rows Count: 3.

12:51:54.954  TRACE  BeforeExecute
DisposeTransaction
12:51:54.954  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002019

12:51:54.954  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

12:51:54.954  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002500

12:51:54.954  TRACE  Total Execution Time (Completed): 00:00:00.0004552. Rows Count: 1.

12:51:54.954  TRACE  Send message {AssistantNotification, eecfe5fe-eb58-4875-8aaa-f4a783d3ed57, Json, 202 bytes}.
12:51:54.954  TRACE  Receive message {GetScanResults, 7ea6115b-78e7-a142-a574-201d20289444, Json, 38 bytes}.
12:51:54.954  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:51:54.954  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004419

12:51:54.954  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [x]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		WHERE
			[x].[ProjectId] = @id
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:51:54.954  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003346

12:51:54.954  TRACE  Total Execution Time (Completed): 00:00:00.0005795. Rows Count: 2.

12:51:54.954  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [x]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		WHERE
			[x].[ProjectId] = @id
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:51:54.954  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002459

12:51:54.954  TRACE  Total Execution Time (Completed): 00:00:00.0004735. Rows Count: 5.

12:51:54.954  TRACE  BeforeExecute
DisposeTransaction
12:51:54.954  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001958

12:51:54.954  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id

12:51:54.954  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003545

12:51:54.954  TRACE  Total Execution Time (Completed): 00:00:00.0006536. Rows Count: 1.

12:51:54.963  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0

SELECT
	[x].[ScanResultId],
	[x].[Level],
	Sum([x].[Count])
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	[x].[State] <> 2 AND [x].[IsSuppressed] = @isSuppressed
GROUP BY
	[x].[ScanResultId],
	[x].[Level]

12:51:54.963  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003960

12:51:54.963  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009537. Rows Count: 3.

12:51:54.963  TRACE  Send message {ScanResults, bae66bee-8594-174c-9239-b457dc7ab635, Json, 1268 bytes}.
12:51:54.963  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:51:54.963  TRACE  Query Execution Time (AfterExecute): 00:00:00.0005545

12:51:54.963  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

12:51:54.963  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002992

12:51:54.963  TRACE  Total Execution Time (Completed): 00:00:00.0005340. Rows Count: 3.

12:51:54.963  TRACE  BeforeExecute
DisposeTransaction
12:51:54.963  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002161

12:51:54.963  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

12:51:54.963  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002549

12:51:54.963  TRACE  Total Execution Time (Completed): 00:00:00.0004665. Rows Count: 1.

12:51:54.963  TRACE  Send message {AssistantNotification, 7899ff96-40fb-4132-925e-efeac1a73b27, Json, 171 bytes}.
12:51:54.986  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:51:54.986  TRACE  Query Execution Time (AfterExecute): 00:00:00.0006857

12:51:54.986  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

12:51:54.986  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002610

12:51:54.986  TRACE  Total Execution Time (Completed): 00:00:00.0005065. Rows Count: 3.

12:51:54.986  TRACE  BeforeExecute
DisposeTransaction
12:51:54.986  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002375

12:51:54.986  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

12:51:54.986  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002573

12:51:54.986  TRACE  Total Execution Time (Completed): 00:00:00.0004612. Rows Count: 1.

12:51:54.986  TRACE  Send message {AssistantNotification, 6f76de77-9969-4ecc-b7fa-9372f4f9f1bd, Json, 202 bytes}.
12:51:55.000  TRACE  Receive message {GetScanResults, bae66bee-8594-174c-9239-b457dc7ab635, Json, 38 bytes}.
12:52:00.429  TRACE  update feeds completed
12:52:57.063  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D9A54232EC14FB4A92D5BBA05775DD79'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:52:57.063  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006674

12:52:57.063  TRACE  Total Execution Time (Completed) (async): 00:00:00.0029654. Rows Count: 1.

12:52:57.080  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:52:57.080  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004777

12:52:57.131  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Key NVarChar(28) -- String
SET     @Key = 'TB5sxMTpY0YN/dVrsvJREu576PY='
DECLARE @IssueType  -- Byte
SET     @IssueType = 1
DECLARE @ApprovalState  -- Byte
SET     @ApprovalState = 2
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @ObsoleteInScanResultId  -- Guid
SET     @ObsoleteInScanResultId = NULL
DECLARE @IsNewInScanResultId  -- Guid
SET     @IsNewInScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Language  -- Int32
SET     @Language = 1
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Data Binary(1306)
SET     @Data = X'DE0024A672767050766FC0A969737375655479706501AA696E7465726E616C4964D92433323432613564392D313465632D346166622D393264352D626261303537373564643739A26964BC54423573784D54705930594E2F64567273764A524575353736'
-- value above truncated for logging
DECLARE @Id  -- Guid
SET     @Id = X'D9A54232EC14FB4A92D5BBA05775DD79'

UPDATE
	[IssueEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Key] = @Key,
	[IssueType] = @IssueType,
	[ApprovalState] = @ApprovalState,
	[Level] = @Level,
	[ObsoleteInScanResultId] = @ObsoleteInScanResultId,
	[IsNewInScanResultId] = @IsNewInScanResultId,
	[Language] = @Language,
	[ScanAppType] = @ScanAppType,
	[Data] = @Data
WHERE
	[IssueEntity].[Id] = @Id

12:52:57.131  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0028442. Records Affected: 1.

12:52:57.131  TRACE  Total Execution Time (Completed) (async): 00:00:00.0060517. Rows Count: 0.

12:52:57.131  DEBUG  Issue ID: 3242a5d9-14ec-4afb-92d5-bba05775dd79 Links count: 0
12:52:57.135  TRACE  BeforeExecute
CommitTransactionAsync
12:52:57.135  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0075416

12:52:57.162  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

INSERT INTO [DiscardedHashEntity]
(
	[Id],
	[Hash]
)
VALUES
(X'FF22ED7B5CB630429CB6A8E56FD3D62F','TB5sxMTpY0YN/dVrsvJREu576PY=')

12:52:57.170  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0077537. Records Affected: 1.

12:52:57.170  TRACE  Total Execution Time (Completed) (async): 00:00:00.0083396. Rows Count: 1.

12:52:57.170  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:52:57.170  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004577

12:52:57.170  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008272. Rows Count: 1.

12:52:57.170  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) >= DateTime(@scanDate)
ORDER BY
	[x].[ScanDate]

12:52:57.170  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005459

12:52:57.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0014540. Rows Count: 1.

12:52:57.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @issueType  -- Byte
SET     @issueType = 1
DECLARE @type NVarChar(13) -- String
SET     @type = 'OS Commanding'
DECLARE @level  -- Byte
SET     @level = 40
DECLARE @state  -- Byte
SET     @state = 0
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Class],
	[x].[Type],
	[x].[Level],
	[x].[State],
	[x].[IsSuppressed],
	[x].[Count]
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] = @id AND
	[x].[Class] = @issueType AND
	[x].[Type] = @type AND
	[x].[Level] = @level AND
	[x].[State] = @state AND
	[x].[IsSuppressed] = @isSuppressed
LIMIT @take

12:52:57.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006072

12:52:57.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0024175. Rows Count: 0.

12:52:57.196  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:52:57.196  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003079

12:52:57.196  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Class  -- Byte
SET     @Class = 1
DECLARE @Type NVarChar(13) -- String
SET     @Type = 'OS Commanding'
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @State  -- Byte
SET     @State = 0
DECLARE @IsSuppressed  -- Boolean
SET     @IsSuppressed = 0
DECLARE @Count  -- Int32
SET     @Count = 0
DECLARE @Id  -- Guid
SET     @Id = X'440AB0C52F0C264D874030FC35F3DF53'

UPDATE
	[IssueStatisticEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Class] = @Class,
	[Type] = @Type,
	[Level] = @Level,
	[State] = @State,
	[IsSuppressed] = @IsSuppressed,
	[Count] = @Count
WHERE
	[IssueStatisticEntity].[Id] = @Id

12:52:57.196  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0010778. Records Affected: 1.

12:52:57.196  TRACE  Total Execution Time (Completed) (async): 00:00:00.0015813. Rows Count: 0.

12:52:57.196  TRACE  BeforeExecute
CommitTransactionAsync
12:52:57.196  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0067530

12:52:57.211  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @issueType  -- Byte
SET     @issueType = 1
DECLARE @type NVarChar(13) -- String
SET     @type = 'OS Commanding'
DECLARE @level  -- Byte
SET     @level = 40
DECLARE @state  -- Byte
SET     @state = 2
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Class],
	[x].[Type],
	[x].[Level],
	[x].[State],
	[x].[IsSuppressed],
	[x].[Count]
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] = @id AND
	[x].[Class] = @issueType AND
	[x].[Type] = @type AND
	[x].[Level] = @level AND
	[x].[State] = @state AND
	[x].[IsSuppressed] = @isSuppressed
LIMIT @take

12:52:57.211  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004337

12:52:57.211  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010112. Rows Count: 0.

12:52:57.211  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

INSERT INTO [IssueStatisticEntity]
(
	[Id],
	[ScanResultId],
	[Class],
	[Type],
	[Level],
	[State],
	[IsSuppressed],
	[Count]
)
VALUES
(X'A0C57CE0EC798D4DAC13646C6BC3B346',X'D2F453435946464080D096152006C012',1,'OS Commanding',40,2,0,1)

12:52:57.211  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0072327. Records Affected: 1.

12:52:57.211  TRACE  Total Execution Time (Completed) (async): 00:00:00.0075851. Rows Count: 1.

12:52:57.211  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:52:57.211  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002907

12:52:57.211  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:52:57.211  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003617

12:52:57.211  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006591. Rows Count: 2.

12:52:57.211  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:52:57.211  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002540

12:52:57.211  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005059. Rows Count: 5.

12:52:57.211  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

12:52:57.211  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006079

12:52:57.211  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010877. Rows Count: 1.

12:52:57.211  TRACE  BeforeExecute
DisposeTransactionAsync
12:52:57.227  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002941

12:52:57.227  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0

SELECT
	[x].[ScanResultId],
	[x].[Level],
	Sum([x].[Count])
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	[x].[State] <> 2 AND [x].[IsSuppressed] = @isSuppressed
GROUP BY
	[x].[ScanResultId],
	[x].[Level]

12:52:57.227  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003222

12:52:57.227  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007633. Rows Count: 3.

12:52:57.227  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:52:57.227  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002744

12:52:57.257  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:52:57.257  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005276

12:52:57.258  TRACE  Total Execution Time (Completed) (async): 00:00:00.0018091. Rows Count: 2.

12:52:57.258  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:52:57.258  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003498

12:52:57.258  TRACE  Total Execution Time (Completed) (async): 00:00:00.0017333. Rows Count: 5.

12:52:57.258  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

12:52:57.258  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003892

12:52:57.258  TRACE  Total Execution Time (Completed) (async): 00:00:00.0048096. Rows Count: 1.

12:52:57.258  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 6
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

12:52:57.258  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004202. Records Affected: 1.

12:52:57.258  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007457. Rows Count: 0.

12:52:57.280  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(16) -- String
SET     @ScanDurationRaw = '00:00:13.2435851'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 1
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 3
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 2
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 6
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 6
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 5
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

12:52:57.280  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0010836. Records Affected: 1.

12:52:57.280  TRACE  Total Execution Time (Completed) (async): 00:00:00.0016390. Rows Count: 0.

12:52:57.280  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'D2F453435946464080D096152006C012'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'7E27BACA8700E842B6843C893D9F7AF9'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-15 06:49:34.797'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

12:52:57.280  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007732. Records Affected: 1.

12:52:57.280  TRACE  Total Execution Time (Completed) (async): 00:00:00.0011249. Rows Count: 0.

12:52:57.291  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'6A0379D5C60F86469FCE9AFEE81A6357'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:52:57.291  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007027. Records Affected: 1.

12:52:57.291  TRACE  Total Execution Time (Completed) (async): 00:00:00.0012361. Rows Count: 0.

12:52:57.291  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'D6AC90AEC931E246B2A26014EB3924CF'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:52:57.291  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003818. Records Affected: 1.

12:52:57.291  TRACE  Total Execution Time (Completed) (async): 00:00:00.0012649. Rows Count: 0.

12:52:57.291  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'3B715A1CBF423C4C9F627DA5D74D9EF1'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

12:52:57.291  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003652. Records Affected: 1.

12:52:57.291  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006223. Rows Count: 0.

12:52:57.291  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'3B715A1CBF423C4C9F627DA5D74D9EF1'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:52:57.291  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002832. Records Affected: 1.

12:52:57.291  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005084. Rows Count: 0.

12:52:57.291  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'34DAEBE5A2178E49B3E3FDAE6B6F68D1'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

12:52:57.291  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002771. Records Affected: 1.

12:52:57.291  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004710. Rows Count: 0.

12:52:57.291  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'34DAEBE5A2178E49B3E3FDAE6B6F68D1'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:52:57.291  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002467. Records Affected: 1.

12:52:57.291  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004406. Rows Count: 0.

12:52:57.291  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'A73BBCD4C7C5014CADFE2F3312124AFD'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:52:57.291  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002453. Records Affected: 1.

12:52:57.291  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004423. Rows Count: 0.

12:52:57.291  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'A73BBCD4C7C5014CADFE2F3312124AFD'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

12:52:57.291  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002384. Records Affected: 1.

12:52:57.291  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004714. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'2E25F990A016024A829951F091109E11'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002233. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004150. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'2E25F990A016024A829951F091109E11'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002396. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004713. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'825ECF382702FE40B4173E5BFEBC5D41'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003950. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006663. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'F655ED325EEC5D42A8CB7F0B3797E0ED'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002957. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004917. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'E8850BE084219746B69F5E14023AC894'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002245. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004246. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'DCB2D83F34C5A542BE88ADE088B6297A'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002280. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004168. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C038900CDC3DB043BA27E231B98671FA'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001964. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003761. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'D775712D2782C44893DB7266307EC272'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003257. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005781. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4F4196B23EF2F74C9CF597CFED8DA2CC'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002425. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004314. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'7C571EA1E64EC247BF2880611210247A'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002123. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003970. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'F993EB1D8AA96F4986C160285D2A52D9'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002358. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004279. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C3A8C6DDD2EFC140BB1377C5FD96B800'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002520. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004393. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'D6AC90AEC931E246B2A26014EB3924CF'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

12:52:57.305  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003256. Records Affected: 1.

12:52:57.305  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006305. Rows Count: 0.

12:52:57.305  TRACE  BeforeExecute
CommitTransactionAsync
12:52:57.327  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0071599

12:52:57.327  TRACE  Send message {EnqueueScanDeltaRecieved, 5669769a-8cfe-4a96-811d-536887bdebde, Json, 244 bytes}.
12:52:57.339  TRACE  Send message {IssueStateUpdated, ba72bc05-9f46-2140-b519-6d4613d3fe4e, Json, 7 bytes}.
12:52:57.359  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[issue].[IssueHash],
	[issue].[AssistantTipEntityId],
	[issue].[Status]
FROM
	[AssistantTipIssueEntity] [issue]
WHERE
	[issue].[IssueHash] IN ('TB5sxMTpY0YN/dVrsvJREu576PY=')

12:52:57.359  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005596

12:52:57.359  TRACE  Total Execution Time (Completed) (async): 00:00:00.0020426. Rows Count: 1.

12:52:57.359  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:52:57.368  TRACE  Query Execution Time (AfterExecute): 00:00:00.0005336

12:52:57.368  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [tip]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [tip].[Id] = [detail].[AssistantTipEntityId]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:52:57.368  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003483

12:52:57.368  TRACE  Total Execution Time (Completed): 00:00:00.0019419. Rows Count: 3.

12:52:57.368  TRACE  BeforeExecute
DisposeTransaction
12:52:57.368  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002234

12:52:57.368  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[tip].[Type],
	[tip].[State],
	[tip].[Metadata],
	[tip].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [tip]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:52:57.368  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003194

12:52:57.368  TRACE  Total Execution Time (Completed): 00:00:00.0018985. Rows Count: 1.

12:52:57.368  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:52:57.368  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002647

12:52:57.368  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:52:57.368  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003220

12:52:57.368  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005739. Rows Count: 2.

12:52:57.368  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:52:57.368  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002574

12:52:57.368  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004931. Rows Count: 5.

12:52:57.368  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

12:52:57.368  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004345

12:52:57.368  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007166. Rows Count: 0.

12:52:57.368  TRACE  BeforeExecute
DisposeTransactionAsync
12:52:57.368  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002072

12:52:57.368  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:52:57.368  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002822

12:52:57.368  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005395. Rows Count: 1.

12:52:57.368  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

12:52:57.368  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002894

12:52:57.368  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005151. Rows Count: 1.

12:52:57.368  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'D2F453435946464080D096152006C012') OR [x].[ObsoleteInScanResultId] IS NULL))

12:52:57.368  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002656

12:52:57.368  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007297. Rows Count: 7.

12:52:57.368  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:52:57.368  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004720

12:52:57.368  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

12:52:57.368  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003765

12:52:57.368  TRACE  Total Execution Time (Completed): 00:00:00.0005982. Rows Count: 3.

12:52:57.368  TRACE  BeforeExecute
DisposeTransaction
12:52:57.368  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002393

12:52:57.383  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

12:52:57.383  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003100

12:52:57.383  TRACE  Total Execution Time (Completed): 00:00:00.0005283. Rows Count: 1.

12:52:57.383  TRACE  Send message {AssistantNotification, a8786acf-e7fb-4f58-83c9-29f676d4a111, Json, 171 bytes}.
12:52:57.401  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[issue].[IssueHash],
	[issue].[AssistantTipEntityId],
	[issue].[Status]
FROM
	[AssistantTipIssueEntity] [issue]
WHERE
	[issue].[IssueHash] IN ('TB5sxMTpY0YN/dVrsvJREu576PY=')

12:52:57.401  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004987

12:52:57.401  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009786. Rows Count: 1.

12:52:57.401  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:52:57.401  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002657

12:52:57.401  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [tip]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [tip].[Id] = [detail].[AssistantTipEntityId]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:52:57.401  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002270

12:52:57.401  TRACE  Total Execution Time (Completed): 00:00:00.0005439. Rows Count: 3.

12:52:57.401  TRACE  BeforeExecute
DisposeTransaction
12:52:57.401  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001876

12:52:57.401  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[tip].[Type],
	[tip].[State],
	[tip].[Metadata],
	[tip].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [tip]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:52:57.401  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002386

12:52:57.401  TRACE  Total Execution Time (Completed): 00:00:00.0004973. Rows Count: 1.

12:52:57.401  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:52:57.401  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002405

12:52:57.401  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:52:57.401  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002949

12:52:57.401  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005443. Rows Count: 2.

12:52:57.401  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:52:57.401  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002902

12:52:57.401  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005299. Rows Count: 5.

12:52:57.401  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

12:52:57.401  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003243

12:52:57.401  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005767. Rows Count: 0.

12:52:57.401  TRACE  BeforeExecute
DisposeTransactionAsync
12:52:57.401  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002004

12:52:57.401  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:52:57.401  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003015

12:52:57.401  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006274. Rows Count: 1.

12:52:57.401  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

12:52:57.401  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003039

12:52:57.401  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005157. Rows Count: 1.

12:52:57.401  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'D2F453435946464080D096152006C012') OR [x].[ObsoleteInScanResultId] IS NULL))

12:52:57.401  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002666

12:52:57.401  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006637. Rows Count: 7.

12:52:57.401  TRACE  Receive message {UpdateIssueState, ba72bc05-9f46-2140-b519-6d4613d3fe4e, Json, 134 bytes}.
12:55:20.403  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D9A54232EC14FB4A92D5BBA05775DD79'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:20.403  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006592

12:55:20.403  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010396. Rows Count: 1.

12:55:20.403  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:20.403  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002874

12:55:20.403  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Key NVarChar(28) -- String
SET     @Key = 'TB5sxMTpY0YN/dVrsvJREu576PY='
DECLARE @IssueType  -- Byte
SET     @IssueType = 1
DECLARE @ApprovalState  -- Byte
SET     @ApprovalState = 1
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @ObsoleteInScanResultId  -- Guid
SET     @ObsoleteInScanResultId = NULL
DECLARE @IsNewInScanResultId  -- Guid
SET     @IsNewInScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Language  -- Int32
SET     @Language = 1
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Data Binary(1306)
SET     @Data = X'DE0024A672767050766FC0A969737375655479706501AA696E7465726E616C4964D92433323432613564392D313465632D346166622D393264352D626261303537373564643739A26964BC54423573784D54705930594E2F64567273764A524575353736'
-- value above truncated for logging
DECLARE @Id  -- Guid
SET     @Id = X'D9A54232EC14FB4A92D5BBA05775DD79'

UPDATE
	[IssueEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Key] = @Key,
	[IssueType] = @IssueType,
	[ApprovalState] = @ApprovalState,
	[Level] = @Level,
	[ObsoleteInScanResultId] = @ObsoleteInScanResultId,
	[IsNewInScanResultId] = @IsNewInScanResultId,
	[Language] = @Language,
	[ScanAppType] = @ScanAppType,
	[Data] = @Data
WHERE
	[IssueEntity].[Id] = @Id

12:55:20.416  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0100795. Records Affected: 1.

12:55:20.416  TRACE  Total Execution Time (Completed) (async): 00:00:00.0104277. Rows Count: 0.

12:55:20.416  DEBUG  Issue ID: 3242a5d9-14ec-4afb-92d5-bba05775dd79 Links count: 0
12:55:20.416  TRACE  BeforeExecute
CommitTransactionAsync
12:55:20.416  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0069154

12:55:20.416  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:20.416  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003374

12:55:20.431  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @hash NVarChar(28) -- String
SET     @hash = 'TB5sxMTpY0YN/dVrsvJREu576PY='

DELETE FROM
	[DiscardedHashEntity]
WHERE
	[DiscardedHashEntity].[Hash] = @hash

12:55:20.431  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0009876. Records Affected: 1.

12:55:20.431  TRACE  Total Execution Time (Completed) (async): 00:00:00.0013724. Rows Count: 0.

12:55:20.431  TRACE  BeforeExecute
CommitTransactionAsync
12:55:20.431  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0066420

12:55:20.431  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:20.431  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003572

12:55:20.431  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006780. Rows Count: 1.

12:55:20.431  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) >= DateTime(@scanDate)
ORDER BY
	[x].[ScanDate]

12:55:20.431  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003365

12:55:20.431  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005545. Rows Count: 1.

12:55:20.431  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @issueType  -- Byte
SET     @issueType = 1
DECLARE @type NVarChar(13) -- String
SET     @type = 'OS Commanding'
DECLARE @level  -- Byte
SET     @level = 40
DECLARE @state  -- Byte
SET     @state = 2
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Class],
	[x].[Type],
	[x].[Level],
	[x].[State],
	[x].[IsSuppressed],
	[x].[Count]
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] = @id AND
	[x].[Class] = @issueType AND
	[x].[Type] = @type AND
	[x].[Level] = @level AND
	[x].[State] = @state AND
	[x].[IsSuppressed] = @isSuppressed
LIMIT @take

12:55:20.431  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003468

12:55:20.431  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009277. Rows Count: 0.

12:55:20.431  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:20.431  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002464

12:55:20.431  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Class  -- Byte
SET     @Class = 1
DECLARE @Type NVarChar(13) -- String
SET     @Type = 'OS Commanding'
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @State  -- Byte
SET     @State = 2
DECLARE @IsSuppressed  -- Boolean
SET     @IsSuppressed = 0
DECLARE @Count  -- Int32
SET     @Count = 0
DECLARE @Id  -- Guid
SET     @Id = X'A0C57CE0EC798D4DAC13646C6BC3B346'

UPDATE
	[IssueStatisticEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Class] = @Class,
	[Type] = @Type,
	[Level] = @Level,
	[State] = @State,
	[IsSuppressed] = @IsSuppressed,
	[Count] = @Count
WHERE
	[IssueStatisticEntity].[Id] = @Id

12:55:20.431  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0008443. Records Affected: 1.

12:55:20.431  TRACE  Total Execution Time (Completed) (async): 00:00:00.0011006. Rows Count: 0.

12:55:20.431  TRACE  BeforeExecute
CommitTransactionAsync
12:55:20.451  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0066942

12:55:20.451  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @issueType  -- Byte
SET     @issueType = 1
DECLARE @type NVarChar(13) -- String
SET     @type = 'OS Commanding'
DECLARE @level  -- Byte
SET     @level = 40
DECLARE @state  -- Byte
SET     @state = 1
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Class],
	[x].[Type],
	[x].[Level],
	[x].[State],
	[x].[IsSuppressed],
	[x].[Count]
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] = @id AND
	[x].[Class] = @issueType AND
	[x].[Type] = @type AND
	[x].[Level] = @level AND
	[x].[State] = @state AND
	[x].[IsSuppressed] = @isSuppressed
LIMIT @take

12:55:20.451  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003971

12:55:20.451  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009296. Rows Count: 0.

12:55:20.451  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

INSERT INTO [IssueStatisticEntity]
(
	[Id],
	[ScanResultId],
	[Class],
	[Type],
	[Level],
	[State],
	[IsSuppressed],
	[Count]
)
VALUES
(X'6B6D753E3460E4428DC3AFF14223A9A0',X'D2F453435946464080D096152006C012',1,'OS Commanding',40,1,0,1)

12:55:20.451  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0073753. Records Affected: 1.

12:55:20.451  TRACE  Total Execution Time (Completed) (async): 00:00:00.0077581. Rows Count: 1.

12:55:20.451  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:55:20.451  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002970

12:55:20.451  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:20.451  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003247

12:55:20.451  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006002. Rows Count: 2.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002559

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005001. Rows Count: 5.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003560

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006197. Rows Count: 1.

12:55:20.462  TRACE  BeforeExecute
DisposeTransactionAsync
12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001924

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0

SELECT
	[x].[ScanResultId],
	[x].[Level],
	Sum([x].[Count])
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	[x].[State] <> 2 AND [x].[IsSuppressed] = @isSuppressed
GROUP BY
	[x].[ScanResultId],
	[x].[Level]

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003328

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008254. Rows Count: 3.

12:55:20.462  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002623

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003040

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005392. Rows Count: 2.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002471

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004854. Rows Count: 5.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003196

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005907. Rows Count: 1.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 6
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002622. Records Affected: 1.

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004611. Rows Count: 0.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(16) -- String
SET     @ScanDurationRaw = '00:00:13.2435851'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 2
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 3
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 2
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 7
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 7
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 5
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007259. Records Affected: 1.

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010589. Rows Count: 0.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'D2F453435946464080D096152006C012'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'7E27BACA8700E842B6843C893D9F7AF9'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-15 06:49:34.797'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007741. Records Affected: 1.

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010038. Rows Count: 0.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'D6AC90AEC931E246B2A26014EB3924CF'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004319. Records Affected: 1.

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006280. Rows Count: 0.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4ACD8A4768D8F7478CF048F30421DF82'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002258. Records Affected: 1.

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004194. Rows Count: 0.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'A73BBCD4C7C5014CADFE2F3312124AFD'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003045. Records Affected: 1.

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004952. Rows Count: 0.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'A73BBCD4C7C5014CADFE2F3312124AFD'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002873. Records Affected: 1.

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004854. Rows Count: 0.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'2E25F990A016024A829951F091109E11'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002080. Records Affected: 1.

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003975. Rows Count: 0.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'2E25F990A016024A829951F091109E11'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002740. Records Affected: 1.

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004673. Rows Count: 0.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B80A934A3B7EBC4388631162F918DBBA'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002314. Records Affected: 1.

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004218. Rows Count: 0.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'B80A934A3B7EBC4388631162F918DBBA'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002431. Records Affected: 1.

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004389. Rows Count: 0.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1FF5E63DA38E72478A250B28E4E4FC9E'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:55:20.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002199. Records Affected: 1.

12:55:20.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004067. Rows Count: 0.

12:55:20.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'1FF5E63DA38E72478A250B28E4E4FC9E'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002114. Records Affected: 1.

12:55:20.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003971. Rows Count: 0.

12:55:20.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'D775712D2782C44893DB7266307EC272'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003943. Records Affected: 1.

12:55:20.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005966. Rows Count: 0.

12:55:20.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4F4196B23EF2F74C9CF597CFED8DA2CC'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002022. Records Affected: 1.

12:55:20.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004031. Rows Count: 0.

12:55:20.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'7C571EA1E64EC247BF2880611210247A'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001981. Records Affected: 1.

12:55:20.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004092. Rows Count: 0.

12:55:20.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'F993EB1D8AA96F4986C160285D2A52D9'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001968. Records Affected: 1.

12:55:20.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003773. Rows Count: 0.

12:55:20.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C3A8C6DDD2EFC140BB1377C5FD96B800'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002027. Records Affected: 1.

12:55:20.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003806. Rows Count: 0.

12:55:20.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'7C194C2BDC4B1B4C83DCEC4AA1D9FA0F'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002654. Records Affected: 1.

12:55:20.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004631. Rows Count: 0.

12:55:20.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'3FFD280BF0A4B4489328598641A05001'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002101. Records Affected: 1.

12:55:20.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003960. Rows Count: 0.

12:55:20.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'783FA1DE4412EA4CB5CAC3DB49680D81'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002280. Records Affected: 1.

12:55:20.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004109. Rows Count: 0.

12:55:20.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'95E56ACD4EDA144FA000517ECB3AD8D0'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002074. Records Affected: 1.

12:55:20.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003905. Rows Count: 0.

12:55:20.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'0F1DF0E1429CDD408EBF8C098951AC95'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002091. Records Affected: 1.

12:55:20.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003900. Rows Count: 0.

12:55:20.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'4ACD8A4768D8F7478CF048F30421DF82'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002888. Records Affected: 1.

12:55:20.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004929. Rows Count: 0.

12:55:20.478  TRACE  BeforeExecute
CommitTransactionAsync
12:55:20.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0074533

12:55:20.478  TRACE  Send message {EnqueueScanDeltaRecieved, 5669769a-8cfe-4a96-811d-536887bdebde, Json, 244 bytes}.
12:55:20.495  TRACE  Send message {IssueStateUpdated, 7ddf66b8-43eb-344d-85e2-6c4e0a311665, Json, 7 bytes}.
12:55:20.511  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[issue].[IssueHash],
	[issue].[AssistantTipEntityId],
	[issue].[Status]
FROM
	[AssistantTipIssueEntity] [issue]
WHERE
	[issue].[IssueHash] IN ('TB5sxMTpY0YN/dVrsvJREu576PY=')

12:55:20.511  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006119

12:55:20.511  TRACE  Total Execution Time (Completed) (async): 00:00:00.0011552. Rows Count: 1.

12:55:20.511  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:55:20.511  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002908

12:55:20.511  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [tip]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [tip].[Id] = [detail].[AssistantTipEntityId]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:20.511  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002461

12:55:20.511  TRACE  Total Execution Time (Completed): 00:00:00.0005954. Rows Count: 3.

12:55:20.511  TRACE  BeforeExecute
DisposeTransaction
12:55:20.511  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002940

12:55:20.511  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[tip].[Type],
	[tip].[State],
	[tip].[Metadata],
	[tip].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [tip]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:20.511  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002794

12:55:20.511  TRACE  Total Execution Time (Completed): 00:00:00.0006066. Rows Count: 1.

12:55:20.511  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:55:20.511  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002723

12:55:20.511  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:20.511  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003715

12:55:20.511  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006523. Rows Count: 2.

12:55:20.511  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:20.511  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003094

12:55:20.511  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005743. Rows Count: 5.

12:55:20.511  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

12:55:20.511  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003487

12:55:20.511  TRACE  Total Execution Time (Completed) (async): 00:00:00.0037158. Rows Count: 0.

12:55:20.511  TRACE  BeforeExecute
DisposeTransactionAsync
12:55:20.511  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002428

12:55:20.511  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:20.511  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003800

12:55:20.511  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006846. Rows Count: 1.

12:55:20.511  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

12:55:20.511  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003312

12:55:20.524  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005496. Rows Count: 1.

12:55:20.524  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'D2F453435946464080D096152006C012') OR [x].[ObsoleteInScanResultId] IS NULL))

12:55:20.524  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002771

12:55:20.524  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007603. Rows Count: 7.

12:55:20.524  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:55:20.524  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004539

12:55:20.524  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

12:55:20.524  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004188

12:55:20.524  TRACE  Total Execution Time (Completed): 00:00:00.0007326. Rows Count: 3.

12:55:20.524  TRACE  BeforeExecute
DisposeTransaction
12:55:20.524  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002053

12:55:20.524  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

12:55:20.524  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002503

12:55:20.524  TRACE  Total Execution Time (Completed): 00:00:00.0004583. Rows Count: 1.

12:55:20.524  TRACE  Send message {AssistantNotification, 10e09f44-c247-42d2-8c13-5c121931fbb0, Json, 171 bytes}.
12:55:20.542  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[issue].[IssueHash],
	[issue].[AssistantTipEntityId],
	[issue].[Status]
FROM
	[AssistantTipIssueEntity] [issue]
WHERE
	[issue].[IssueHash] IN ('TB5sxMTpY0YN/dVrsvJREu576PY=')

12:55:20.542  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004980

12:55:20.542  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009619. Rows Count: 1.

12:55:20.542  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:55:20.542  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002751

12:55:20.542  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [tip]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [tip].[Id] = [detail].[AssistantTipEntityId]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:20.542  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002336

12:55:20.542  TRACE  Total Execution Time (Completed): 00:00:00.0005638. Rows Count: 3.

12:55:20.542  TRACE  BeforeExecute
DisposeTransaction
12:55:20.542  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001883

12:55:20.542  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[tip].[Type],
	[tip].[State],
	[tip].[Metadata],
	[tip].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [tip]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:20.542  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002449

12:55:20.542  TRACE  Total Execution Time (Completed): 00:00:00.0005567. Rows Count: 1.

12:55:20.542  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:55:20.542  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002540

12:55:20.542  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:20.542  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003188

12:55:20.542  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005710. Rows Count: 2.

12:55:20.542  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:20.542  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002568

12:55:20.542  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004914. Rows Count: 5.

12:55:20.542  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

12:55:20.542  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004074

12:55:20.542  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006633. Rows Count: 0.

12:55:20.542  TRACE  BeforeExecute
DisposeTransactionAsync
12:55:20.542  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001896

12:55:20.542  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:20.542  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002807

12:55:20.542  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005310. Rows Count: 1.

12:55:20.542  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

12:55:20.542  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002827

12:55:20.542  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004909. Rows Count: 1.

12:55:20.542  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'D2F453435946464080D096152006C012') OR [x].[ObsoleteInScanResultId] IS NULL))

12:55:20.542  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002664

12:55:20.542  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006882. Rows Count: 7.

12:55:20.542  TRACE  Receive message {UpdateIssueState, 7ddf66b8-43eb-344d-85e2-6c4e0a311665, Json, 135 bytes}.
12:55:20.793  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D9A54232EC14FB4A92D5BBA05775DD79'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:20.793  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006776

12:55:20.793  TRACE  Total Execution Time (Completed) (async): 00:00:00.0011040. Rows Count: 1.

12:55:20.793  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:20.793  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002768

12:55:20.793  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Key NVarChar(28) -- String
SET     @Key = 'TB5sxMTpY0YN/dVrsvJREu576PY='
DECLARE @IssueType  -- Byte
SET     @IssueType = 1
DECLARE @ApprovalState  -- Byte
SET     @ApprovalState = 2
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @ObsoleteInScanResultId  -- Guid
SET     @ObsoleteInScanResultId = NULL
DECLARE @IsNewInScanResultId  -- Guid
SET     @IsNewInScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Language  -- Int32
SET     @Language = 1
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Data Binary(1306)
SET     @Data = X'DE0024A672767050766FC0A969737375655479706501AA696E7465726E616C4964D92433323432613564392D313465632D346166622D393264352D626261303537373564643739A26964BC54423573784D54705930594E2F64567273764A524575353736'
-- value above truncated for logging
DECLARE @Id  -- Guid
SET     @Id = X'D9A54232EC14FB4A92D5BBA05775DD79'

UPDATE
	[IssueEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Key] = @Key,
	[IssueType] = @IssueType,
	[ApprovalState] = @ApprovalState,
	[Level] = @Level,
	[ObsoleteInScanResultId] = @ObsoleteInScanResultId,
	[IsNewInScanResultId] = @IsNewInScanResultId,
	[Language] = @Language,
	[ScanAppType] = @ScanAppType,
	[Data] = @Data
WHERE
	[IssueEntity].[Id] = @Id

12:55:20.793  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0099599. Records Affected: 1.

12:55:20.793  TRACE  Total Execution Time (Completed) (async): 00:00:00.0103390. Rows Count: 0.

12:55:20.793  DEBUG  Issue ID: 3242a5d9-14ec-4afb-92d5-bba05775dd79 Links count: 0
12:55:20.793  TRACE  BeforeExecute
CommitTransactionAsync
12:55:20.813  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0072426

12:55:20.813  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

INSERT INTO [DiscardedHashEntity]
(
	[Id],
	[Hash]
)
VALUES
(X'D2824C5C0FF9B1479DE6607F2209691D','TB5sxMTpY0YN/dVrsvJREu576PY=')

12:55:20.822  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0078756. Records Affected: 1.

12:55:20.822  TRACE  Total Execution Time (Completed) (async): 00:00:00.0081897. Rows Count: 1.

12:55:20.822  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:20.822  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003847

12:55:20.822  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007263. Rows Count: 1.

12:55:20.822  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) >= DateTime(@scanDate)
ORDER BY
	[x].[ScanDate]

12:55:20.822  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003744

12:55:20.822  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006754. Rows Count: 1.

12:55:20.822  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @issueType  -- Byte
SET     @issueType = 1
DECLARE @type NVarChar(13) -- String
SET     @type = 'OS Commanding'
DECLARE @level  -- Byte
SET     @level = 40
DECLARE @state  -- Byte
SET     @state = 1
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Class],
	[x].[Type],
	[x].[Level],
	[x].[State],
	[x].[IsSuppressed],
	[x].[Count]
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] = @id AND
	[x].[Class] = @issueType AND
	[x].[Type] = @type AND
	[x].[Level] = @level AND
	[x].[State] = @state AND
	[x].[IsSuppressed] = @isSuppressed
LIMIT @take

12:55:20.822  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006522

12:55:20.822  TRACE  Total Execution Time (Completed) (async): 00:00:00.0012238. Rows Count: 0.

12:55:20.822  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:20.822  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002495

12:55:20.822  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Class  -- Byte
SET     @Class = 1
DECLARE @Type NVarChar(13) -- String
SET     @Type = 'OS Commanding'
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @State  -- Byte
SET     @State = 1
DECLARE @IsSuppressed  -- Boolean
SET     @IsSuppressed = 0
DECLARE @Count  -- Int32
SET     @Count = 0
DECLARE @Id  -- Guid
SET     @Id = X'6B6D753E3460E4428DC3AFF14223A9A0'

UPDATE
	[IssueStatisticEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Class] = @Class,
	[Type] = @Type,
	[Level] = @Level,
	[State] = @State,
	[IsSuppressed] = @IsSuppressed,
	[Count] = @Count
WHERE
	[IssueStatisticEntity].[Id] = @Id

12:55:20.822  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0009465. Records Affected: 1.

12:55:20.822  TRACE  Total Execution Time (Completed) (async): 00:00:00.0012930. Rows Count: 0.

12:55:20.822  TRACE  BeforeExecute
CommitTransactionAsync
12:55:20.822  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0067257

12:55:20.822  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @issueType  -- Byte
SET     @issueType = 1
DECLARE @type NVarChar(13) -- String
SET     @type = 'OS Commanding'
DECLARE @level  -- Byte
SET     @level = 40
DECLARE @state  -- Byte
SET     @state = 2
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Class],
	[x].[Type],
	[x].[Level],
	[x].[State],
	[x].[IsSuppressed],
	[x].[Count]
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] = @id AND
	[x].[Class] = @issueType AND
	[x].[Type] = @type AND
	[x].[Level] = @level AND
	[x].[State] = @state AND
	[x].[IsSuppressed] = @isSuppressed
LIMIT @take

12:55:20.822  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003937

12:55:20.836  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008529. Rows Count: 0.

12:55:20.836  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:20.836  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002480

12:55:20.836  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Class  -- Byte
SET     @Class = 1
DECLARE @Type NVarChar(13) -- String
SET     @Type = 'OS Commanding'
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @State  -- Byte
SET     @State = 2
DECLARE @IsSuppressed  -- Boolean
SET     @IsSuppressed = 0
DECLARE @Count  -- Int32
SET     @Count = 1
DECLARE @Id  -- Guid
SET     @Id = X'A0C57CE0EC798D4DAC13646C6BC3B346'

UPDATE
	[IssueStatisticEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Class] = @Class,
	[Type] = @Type,
	[Level] = @Level,
	[State] = @State,
	[IsSuppressed] = @IsSuppressed,
	[Count] = @Count
WHERE
	[IssueStatisticEntity].[Id] = @Id

12:55:20.836  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0008695. Records Affected: 1.

12:55:20.836  TRACE  Total Execution Time (Completed) (async): 00:00:00.0011199. Rows Count: 0.

12:55:20.836  TRACE  BeforeExecute
CommitTransactionAsync
12:55:20.836  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0065350

12:55:20.836  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:55:20.836  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002913

12:55:20.836  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:20.836  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003152

12:55:20.836  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005693. Rows Count: 2.

12:55:20.836  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:20.836  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002575

12:55:20.836  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004914. Rows Count: 5.

12:55:20.836  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:20.836  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003533

12:55:20.836  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006043. Rows Count: 1.

12:55:20.836  TRACE  BeforeExecute
DisposeTransactionAsync
12:55:20.836  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001870

12:55:20.836  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0

SELECT
	[x].[ScanResultId],
	[x].[Level],
	Sum([x].[Count])
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	[x].[State] <> 2 AND [x].[IsSuppressed] = @isSuppressed
GROUP BY
	[x].[ScanResultId],
	[x].[Level]

12:55:20.836  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003379

12:55:20.836  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008118. Rows Count: 3.

12:55:20.836  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:20.836  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003390

12:55:20.836  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:20.836  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002910

12:55:20.836  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005458. Rows Count: 2.

12:55:20.836  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:20.836  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002427

12:55:20.836  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004622. Rows Count: 5.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003509

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005948. Rows Count: 1.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 6
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002333. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004198. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(16) -- String
SET     @ScanDurationRaw = '00:00:13.2435851'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 1
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 3
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 2
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 6
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 6
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 5
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007804. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0011938. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'D2F453435946464080D096152006C012'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'7E27BACA8700E842B6843C893D9F7AF9'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-15 06:49:34.797'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005734. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007824. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4ACD8A4768D8F7478CF048F30421DF82'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004365. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006265. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'668BE27ECCB1CB4F9C6BFBAF1A5BE874'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002400. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004255. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'B80A934A3B7EBC4388631162F918DBBA'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002920. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004988. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B80A934A3B7EBC4388631162F918DBBA'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002590. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004439. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'1FF5E63DA38E72478A250B28E4E4FC9E'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002037. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003823. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1FF5E63DA38E72478A250B28E4E4FC9E'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002453. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004303. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'E40281C478C6104FA3900C69FF6216A2'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002127. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003937. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'E40281C478C6104FA3900C69FF6216A2'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002016. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003786. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'BC1E99C9E54EAC4095CAC90EC4330D07'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002359. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004223. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'BC1E99C9E54EAC4095CAC90EC4330D07'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002021. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003801. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'7C194C2BDC4B1B4C83DCEC4AA1D9FA0F'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003044. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004848. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'3FFD280BF0A4B4489328598641A05001'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002385. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004136. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'783FA1DE4412EA4CB5CAC3DB49680D81'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001853. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003569. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'95E56ACD4EDA144FA000517ECB3AD8D0'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001859. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003598. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'0F1DF0E1429CDD408EBF8C098951AC95'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001851. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003565. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'69F3B11303913649973412B7EED3399F'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002451. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004321. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'908A89EF9A030141A1A485CF03A6CCA2'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002211. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004297. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'7AFB93A083B0364BA1663D0FA2FFE84A'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002323. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004111. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'65C6CB40C5184B48874F8EAF19DFDD44'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002041. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003808. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1C71BB0CE7ADFA4B92593B48283AEA06'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002112. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003902. Rows Count: 0.

12:55:20.852  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'668BE27ECCB1CB4F9C6BFBAF1A5BE874'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

12:55:20.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002499. Records Affected: 1.

12:55:20.852  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004381. Rows Count: 0.

12:55:20.868  TRACE  BeforeExecute
CommitTransactionAsync
12:55:20.868  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0073115

12:55:20.868  TRACE  Send message {EnqueueScanDeltaRecieved, 5669769a-8cfe-4a96-811d-536887bdebde, Json, 244 bytes}.
12:55:20.885  TRACE  Send message {IssueStateUpdated, 57ea093b-1d3c-b945-af4a-6f19008598e7, Json, 7 bytes}.
12:55:20.901  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[issue].[IssueHash],
	[issue].[AssistantTipEntityId],
	[issue].[Status]
FROM
	[AssistantTipIssueEntity] [issue]
WHERE
	[issue].[IssueHash] IN ('TB5sxMTpY0YN/dVrsvJREu576PY=')

12:55:20.901  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005253

12:55:20.901  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010724. Rows Count: 1.

12:55:20.901  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:55:20.901  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003867

12:55:20.901  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [tip]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [tip].[Id] = [detail].[AssistantTipEntityId]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:20.901  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003641

12:55:20.901  TRACE  Total Execution Time (Completed): 00:00:00.0007503. Rows Count: 3.

12:55:20.901  TRACE  BeforeExecute
DisposeTransaction
12:55:20.901  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002824

12:55:20.901  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[tip].[Type],
	[tip].[State],
	[tip].[Metadata],
	[tip].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [tip]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:20.901  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003512

12:55:20.901  TRACE  Total Execution Time (Completed): 00:00:00.0006997. Rows Count: 1.

12:55:20.901  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:55:20.901  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003351

12:55:20.901  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:20.901  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003989

12:55:20.901  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007252. Rows Count: 2.

12:55:20.901  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:20.901  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004059

12:55:20.901  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007397. Rows Count: 5.

12:55:20.901  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

12:55:20.901  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005398

12:55:20.901  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008977. Rows Count: 0.

12:55:20.901  TRACE  BeforeExecute
DisposeTransactionAsync
12:55:20.901  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002964

12:55:20.901  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:20.901  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004158

12:55:20.901  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007743. Rows Count: 1.

12:55:20.901  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

12:55:20.901  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004198

12:55:20.901  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007134. Rows Count: 1.

12:55:20.901  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'D2F453435946464080D096152006C012') OR [x].[ObsoleteInScanResultId] IS NULL))

12:55:20.901  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003614

12:55:20.901  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008109. Rows Count: 7.

12:55:20.901  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:55:20.901  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002782

12:55:20.915  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

12:55:20.915  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002450

12:55:20.915  TRACE  Total Execution Time (Completed): 00:00:00.0004643. Rows Count: 3.

12:55:20.915  TRACE  BeforeExecute
DisposeTransaction
12:55:20.915  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001796

12:55:20.915  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

12:55:20.915  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002591

12:55:20.915  TRACE  Total Execution Time (Completed): 00:00:00.0004521. Rows Count: 1.

12:55:20.915  TRACE  Send message {AssistantNotification, 7d2e124f-21c8-4cda-bf2d-19a165571d85, Json, 171 bytes}.
12:55:20.915  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[issue].[IssueHash],
	[issue].[AssistantTipEntityId],
	[issue].[Status]
FROM
	[AssistantTipIssueEntity] [issue]
WHERE
	[issue].[IssueHash] IN ('TB5sxMTpY0YN/dVrsvJREu576PY=')

12:55:20.915  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003691

12:55:20.915  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007331. Rows Count: 1.

12:55:20.915  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:55:20.915  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002672

12:55:20.915  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [tip]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [tip].[Id] = [detail].[AssistantTipEntityId]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:20.915  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002679

12:55:20.915  TRACE  Total Execution Time (Completed): 00:00:00.0005760. Rows Count: 3.

12:55:20.915  TRACE  BeforeExecute
DisposeTransaction
12:55:20.915  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001869

12:55:20.915  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[tip].[Type],
	[tip].[State],
	[tip].[Metadata],
	[tip].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [tip]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:20.915  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002617

12:55:20.915  TRACE  Total Execution Time (Completed): 00:00:00.0005455. Rows Count: 1.

12:55:20.915  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:55:20.915  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002676

12:55:20.915  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:20.915  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003181

12:55:20.915  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005604. Rows Count: 2.

12:55:20.915  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:20.915  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002863

12:55:20.915  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005255. Rows Count: 5.

12:55:20.915  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

12:55:20.915  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003696

12:55:20.915  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006383. Rows Count: 0.

12:55:20.915  TRACE  BeforeExecute
DisposeTransactionAsync
12:55:20.915  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001949

12:55:20.915  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:20.915  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003429

12:55:20.915  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005981. Rows Count: 1.

12:55:20.915  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

12:55:20.915  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003200

12:55:20.915  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005271. Rows Count: 1.

12:55:20.915  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'D2F453435946464080D096152006C012') OR [x].[ObsoleteInScanResultId] IS NULL))

12:55:20.915  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003074

12:55:20.915  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006648. Rows Count: 7.

12:55:20.915  TRACE  Receive message {UpdateIssueState, 57ea093b-1d3c-b945-af4a-6f19008598e7, Json, 134 bytes}.
12:55:40.116  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D9A54232EC14FB4A92D5BBA05775DD79'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:40.116  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006977

12:55:40.116  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010776. Rows Count: 1.

12:55:40.116  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:40.118  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002738

12:55:40.118  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Key NVarChar(28) -- String
SET     @Key = 'TB5sxMTpY0YN/dVrsvJREu576PY='
DECLARE @IssueType  -- Byte
SET     @IssueType = 1
DECLARE @ApprovalState  -- Byte
SET     @ApprovalState = 1
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @ObsoleteInScanResultId  -- Guid
SET     @ObsoleteInScanResultId = NULL
DECLARE @IsNewInScanResultId  -- Guid
SET     @IsNewInScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Language  -- Int32
SET     @Language = 1
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Data Binary(1306)
SET     @Data = X'DE0024A672767050766FC0A969737375655479706501AA696E7465726E616C4964D92433323432613564392D313465632D346166622D393264352D626261303537373564643739A26964BC54423573784D54705930594E2F64567273764A524575353736'
-- value above truncated for logging
DECLARE @Id  -- Guid
SET     @Id = X'D9A54232EC14FB4A92D5BBA05775DD79'

UPDATE
	[IssueEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Key] = @Key,
	[IssueType] = @IssueType,
	[ApprovalState] = @ApprovalState,
	[Level] = @Level,
	[ObsoleteInScanResultId] = @ObsoleteInScanResultId,
	[IsNewInScanResultId] = @IsNewInScanResultId,
	[Language] = @Language,
	[ScanAppType] = @ScanAppType,
	[Data] = @Data
WHERE
	[IssueEntity].[Id] = @Id

12:55:40.118  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0106706. Records Affected: 1.

12:55:40.118  TRACE  Total Execution Time (Completed) (async): 00:00:00.0110550. Rows Count: 0.

12:55:40.118  DEBUG  Issue ID: 3242a5d9-14ec-4afb-92d5-bba05775dd79 Links count: 0
12:55:40.118  TRACE  BeforeExecute
CommitTransactionAsync
12:55:40.137  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0070267

12:55:40.137  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:40.137  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002662

12:55:40.137  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @hash NVarChar(28) -- String
SET     @hash = 'TB5sxMTpY0YN/dVrsvJREu576PY='

DELETE FROM
	[DiscardedHashEntity]
WHERE
	[DiscardedHashEntity].[Hash] = @hash

12:55:40.137  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007461. Records Affected: 1.

12:55:40.137  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010310. Rows Count: 0.

12:55:40.137  TRACE  BeforeExecute
CommitTransactionAsync
12:55:40.137  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0066690

12:55:40.137  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:40.137  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005047

12:55:40.137  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008255. Rows Count: 1.

12:55:40.137  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) >= DateTime(@scanDate)
ORDER BY
	[x].[ScanDate]

12:55:40.137  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003355

12:55:40.137  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005344. Rows Count: 1.

12:55:40.137  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @issueType  -- Byte
SET     @issueType = 1
DECLARE @type NVarChar(13) -- String
SET     @type = 'OS Commanding'
DECLARE @level  -- Byte
SET     @level = 40
DECLARE @state  -- Byte
SET     @state = 2
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Class],
	[x].[Type],
	[x].[Level],
	[x].[State],
	[x].[IsSuppressed],
	[x].[Count]
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] = @id AND
	[x].[Class] = @issueType AND
	[x].[Type] = @type AND
	[x].[Level] = @level AND
	[x].[State] = @state AND
	[x].[IsSuppressed] = @isSuppressed
LIMIT @take

12:55:40.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003054

12:55:40.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006293. Rows Count: 0.

12:55:40.149  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:40.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002525

12:55:40.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Class  -- Byte
SET     @Class = 1
DECLARE @Type NVarChar(13) -- String
SET     @Type = 'OS Commanding'
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @State  -- Byte
SET     @State = 2
DECLARE @IsSuppressed  -- Boolean
SET     @IsSuppressed = 0
DECLARE @Count  -- Int32
SET     @Count = 0
DECLARE @Id  -- Guid
SET     @Id = X'A0C57CE0EC798D4DAC13646C6BC3B346'

UPDATE
	[IssueStatisticEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Class] = @Class,
	[Type] = @Type,
	[Level] = @Level,
	[State] = @State,
	[IsSuppressed] = @IsSuppressed,
	[Count] = @Count
WHERE
	[IssueStatisticEntity].[Id] = @Id

12:55:40.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007871. Records Affected: 1.

12:55:40.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009835. Rows Count: 0.

12:55:40.149  TRACE  BeforeExecute
CommitTransactionAsync
12:55:40.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0064335

12:55:40.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @issueType  -- Byte
SET     @issueType = 1
DECLARE @type NVarChar(13) -- String
SET     @type = 'OS Commanding'
DECLARE @level  -- Byte
SET     @level = 40
DECLARE @state  -- Byte
SET     @state = 1
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Class],
	[x].[Type],
	[x].[Level],
	[x].[State],
	[x].[IsSuppressed],
	[x].[Count]
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] = @id AND
	[x].[Class] = @issueType AND
	[x].[Type] = @type AND
	[x].[Level] = @level AND
	[x].[State] = @state AND
	[x].[IsSuppressed] = @isSuppressed
LIMIT @take

12:55:40.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003360

12:55:40.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006919. Rows Count: 0.

12:55:40.149  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:40.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002274

12:55:40.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Class  -- Byte
SET     @Class = 1
DECLARE @Type NVarChar(13) -- String
SET     @Type = 'OS Commanding'
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @State  -- Byte
SET     @State = 1
DECLARE @IsSuppressed  -- Boolean
SET     @IsSuppressed = 0
DECLARE @Count  -- Int32
SET     @Count = 1
DECLARE @Id  -- Guid
SET     @Id = X'6B6D753E3460E4428DC3AFF14223A9A0'

UPDATE
	[IssueStatisticEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Class] = @Class,
	[Type] = @Type,
	[Level] = @Level,
	[State] = @State,
	[IsSuppressed] = @IsSuppressed,
	[Count] = @Count
WHERE
	[IssueStatisticEntity].[Id] = @Id

12:55:40.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007564. Records Affected: 1.

12:55:40.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009525. Rows Count: 0.

12:55:40.149  TRACE  BeforeExecute
CommitTransactionAsync
12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0068923

12:55:40.167  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002600

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003257

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005529. Rows Count: 2.

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002612

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004854. Rows Count: 5.

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003213

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005533. Rows Count: 1.

12:55:40.167  TRACE  BeforeExecute
DisposeTransactionAsync
12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001882

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0

SELECT
	[x].[ScanResultId],
	[x].[Level],
	Sum([x].[Count])
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	[x].[State] <> 2 AND [x].[IsSuppressed] = @isSuppressed
GROUP BY
	[x].[ScanResultId],
	[x].[Level]

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003320

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006915. Rows Count: 3.

12:55:40.167  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002364

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002472

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004577. Rows Count: 2.

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002287

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004346. Rows Count: 5.

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003273

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005466. Rows Count: 1.

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 6
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002123. Records Affected: 1.

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003932. Rows Count: 0.

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(16) -- String
SET     @ScanDurationRaw = '00:00:13.2435851'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 2
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 3
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 2
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 7
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 7
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 5
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006825. Records Affected: 1.

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009944. Rows Count: 0.

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'D2F453435946464080D096152006C012'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'7E27BACA8700E842B6843C893D9F7AF9'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-15 06:49:34.797'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005054. Records Affected: 1.

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006986. Rows Count: 0.

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'668BE27ECCB1CB4F9C6BFBAF1A5BE874'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004004. Records Affected: 1.

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005861. Rows Count: 0.

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'7C3D07765584C144BEF89AC491C5B37A'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003172. Records Affected: 1.

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005934. Rows Count: 0.

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'E40281C478C6104FA3900C69FF6216A2'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002947. Records Affected: 1.

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004751. Rows Count: 0.

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'E40281C478C6104FA3900C69FF6216A2'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002381. Records Affected: 1.

12:55:40.167  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004189. Rows Count: 0.

12:55:40.167  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'BC1E99C9E54EAC4095CAC90EC4330D07'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

12:55:40.167  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001981. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005294. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'BC1E99C9E54EAC4095CAC90EC4330D07'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003347. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005478. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4DFCE0FD16B085419AAC935BD99183A1'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002168. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004037. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'4DFCE0FD16B085419AAC935BD99183A1'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001978. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003729. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B343746E2B998F48869EE6AA67134EB6'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001978. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003926. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'B343746E2B998F48869EE6AA67134EB6'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001925. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003647. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'69F3B11303913649973412B7EED3399F'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002914. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004693. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'908A89EF9A030141A1A485CF03A6CCA2'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001817. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003500. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'7AFB93A083B0364BA1663D0FA2FFE84A'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001778. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003764. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'65C6CB40C5184B48874F8EAF19DFDD44'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001801. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003483. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1C71BB0CE7ADFA4B92593B48283AEA06'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001813. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003518. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'FFF7E86A95D8EC439963A85D1D54B247'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002423. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004452. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'11EEA74BCC419E4281D01FCACE2DE3A0'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002034. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003866. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'CCB8349813D5064090435FE7746F7541'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001930. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003655. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'A133B4DDB7110F45B64843DF18B24EBC'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001921. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003948. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'610989587E7B004D80ABCADC8DB237C6'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002249. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004170. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'7C3D07765584C144BEF89AC491C5B37A'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

12:55:40.180  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002382. Records Affected: 1.

12:55:40.180  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004255. Rows Count: 0.

12:55:40.180  TRACE  BeforeExecute
CommitTransactionAsync
12:55:40.197  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0075558

12:55:40.197  TRACE  Send message {EnqueueScanDeltaRecieved, 5669769a-8cfe-4a96-811d-536887bdebde, Json, 244 bytes}.
12:55:40.197  TRACE  Send message {IssueStateUpdated, 8edfbd34-e10d-7b42-be1f-77dc3fc8c7f1, Json, 7 bytes}.
12:55:40.226  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[issue].[IssueHash],
	[issue].[AssistantTipEntityId],
	[issue].[Status]
FROM
	[AssistantTipIssueEntity] [issue]
WHERE
	[issue].[IssueHash] IN ('TB5sxMTpY0YN/dVrsvJREu576PY=')

12:55:40.227  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005628

12:55:40.227  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009490. Rows Count: 1.

12:55:40.227  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:55:40.227  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002707

12:55:40.227  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [tip]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [tip].[Id] = [detail].[AssistantTipEntityId]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:40.227  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002672

12:55:40.227  TRACE  Total Execution Time (Completed): 00:00:00.0005889. Rows Count: 3.

12:55:40.227  TRACE  BeforeExecute
DisposeTransaction
12:55:40.227  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002945

12:55:40.227  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[tip].[Type],
	[tip].[State],
	[tip].[Metadata],
	[tip].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [tip]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:40.227  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002808

12:55:40.227  TRACE  Total Execution Time (Completed): 00:00:00.0005729. Rows Count: 1.

12:55:40.227  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:55:40.227  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002700

12:55:40.227  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:40.227  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003660

12:55:40.227  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006078. Rows Count: 2.

12:55:40.227  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:40.227  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002745

12:55:40.227  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005113. Rows Count: 5.

12:55:40.227  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

12:55:40.227  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003892

12:55:40.227  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006471. Rows Count: 0.

12:55:40.227  TRACE  BeforeExecute
DisposeTransactionAsync
12:55:40.227  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002015

12:55:40.227  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:40.227  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002979

12:55:40.227  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005326. Rows Count: 1.

12:55:40.227  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

12:55:40.227  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002860

12:55:40.227  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004824. Rows Count: 1.

12:55:40.227  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'D2F453435946464080D096152006C012') OR [x].[ObsoleteInScanResultId] IS NULL))

12:55:40.227  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002742

12:55:40.227  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006447. Rows Count: 7.

12:55:40.227  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:55:40.227  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002781

12:55:40.227  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

12:55:40.227  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004787

12:55:40.227  TRACE  Total Execution Time (Completed): 00:00:00.0007633. Rows Count: 3.

12:55:40.227  TRACE  BeforeExecute
DisposeTransaction
12:55:40.227  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002853

12:55:40.227  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

12:55:40.227  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003974

12:55:40.227  TRACE  Total Execution Time (Completed): 00:00:00.0006241. Rows Count: 1.

12:55:40.227  TRACE  Send message {AssistantNotification, 36e33f7e-0ea1-4a46-9cde-a6098a2d4e4b, Json, 171 bytes}.
12:55:40.227  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[issue].[IssueHash],
	[issue].[AssistantTipEntityId],
	[issue].[Status]
FROM
	[AssistantTipIssueEntity] [issue]
WHERE
	[issue].[IssueHash] IN ('TB5sxMTpY0YN/dVrsvJREu576PY=')

12:55:40.242  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006217

12:55:40.242  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010747. Rows Count: 1.

12:55:40.242  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:55:40.242  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002627

12:55:40.242  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [tip]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [tip].[Id] = [detail].[AssistantTipEntityId]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:40.242  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002323

12:55:40.242  TRACE  Total Execution Time (Completed): 00:00:00.0005098. Rows Count: 3.

12:55:40.242  TRACE  BeforeExecute
DisposeTransaction
12:55:40.242  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001848

12:55:40.242  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[tip].[Type],
	[tip].[State],
	[tip].[Metadata],
	[tip].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [tip]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:40.242  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002491

12:55:40.242  TRACE  Total Execution Time (Completed): 00:00:00.0004905. Rows Count: 1.

12:55:40.242  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:55:40.242  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002930

12:55:40.242  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:40.242  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002990

12:55:40.242  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005526. Rows Count: 2.

12:55:40.242  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:40.242  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002486

12:55:40.242  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004630. Rows Count: 5.

12:55:40.242  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

12:55:40.242  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003552

12:55:40.242  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005924. Rows Count: 0.

12:55:40.242  TRACE  BeforeExecute
DisposeTransactionAsync
12:55:40.242  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001862

12:55:40.242  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:40.242  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002741

12:55:40.242  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004935. Rows Count: 1.

12:55:40.242  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

12:55:40.242  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002783

12:55:40.242  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004722. Rows Count: 1.

12:55:40.242  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'D2F453435946464080D096152006C012') OR [x].[ObsoleteInScanResultId] IS NULL))

12:55:40.242  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003181

12:55:40.242  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006216. Rows Count: 7.

12:55:40.242  TRACE  Receive message {UpdateIssueState, 8edfbd34-e10d-7b42-be1f-77dc3fc8c7f1, Json, 135 bytes}.
12:55:40.538  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D9A54232EC14FB4A92D5BBA05775DD79'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:40.538  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007835

12:55:40.538  TRACE  Total Execution Time (Completed) (async): 00:00:00.0013589. Rows Count: 1.

12:55:40.540  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:40.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003227

12:55:40.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Key NVarChar(28) -- String
SET     @Key = 'TB5sxMTpY0YN/dVrsvJREu576PY='
DECLARE @IssueType  -- Byte
SET     @IssueType = 1
DECLARE @ApprovalState  -- Byte
SET     @ApprovalState = 2
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @ObsoleteInScanResultId  -- Guid
SET     @ObsoleteInScanResultId = NULL
DECLARE @IsNewInScanResultId  -- Guid
SET     @IsNewInScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Language  -- Int32
SET     @Language = 1
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Data Binary(1306)
SET     @Data = X'DE0024A672767050766FC0A969737375655479706501AA696E7465726E616C4964D92433323432613564392D313465632D346166622D393264352D626261303537373564643739A26964BC54423573784D54705930594E2F64567273764A524575353736'
-- value above truncated for logging
DECLARE @Id  -- Guid
SET     @Id = X'D9A54232EC14FB4A92D5BBA05775DD79'

UPDATE
	[IssueEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Key] = @Key,
	[IssueType] = @IssueType,
	[ApprovalState] = @ApprovalState,
	[Level] = @Level,
	[ObsoleteInScanResultId] = @ObsoleteInScanResultId,
	[IsNewInScanResultId] = @IsNewInScanResultId,
	[Language] = @Language,
	[ScanAppType] = @ScanAppType,
	[Data] = @Data
WHERE
	[IssueEntity].[Id] = @Id

12:55:40.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0109729. Records Affected: 1.

12:55:40.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0114396. Rows Count: 0.

12:55:40.540  DEBUG  Issue ID: 3242a5d9-14ec-4afb-92d5-bba05775dd79 Links count: 0
12:55:40.540  TRACE  BeforeExecute
CommitTransactionAsync
12:55:40.560  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0068310

12:55:40.560  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

INSERT INTO [DiscardedHashEntity]
(
	[Id],
	[Hash]
)
VALUES
(X'7F99D71735B0B748BB9A7F21A4E8F838','TB5sxMTpY0YN/dVrsvJREu576PY=')

12:55:40.560  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0075172. Records Affected: 1.

12:55:40.560  TRACE  Total Execution Time (Completed) (async): 00:00:00.0078800. Rows Count: 1.

12:55:40.560  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:40.560  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003472

12:55:40.560  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006011. Rows Count: 1.

12:55:40.560  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) >= DateTime(@scanDate)
ORDER BY
	[x].[ScanDate]

12:55:40.560  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003091

12:55:40.560  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005006. Rows Count: 1.

12:55:40.560  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @issueType  -- Byte
SET     @issueType = 1
DECLARE @type NVarChar(13) -- String
SET     @type = 'OS Commanding'
DECLARE @level  -- Byte
SET     @level = 40
DECLARE @state  -- Byte
SET     @state = 1
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Class],
	[x].[Type],
	[x].[Level],
	[x].[State],
	[x].[IsSuppressed],
	[x].[Count]
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] = @id AND
	[x].[Class] = @issueType AND
	[x].[Type] = @type AND
	[x].[Level] = @level AND
	[x].[State] = @state AND
	[x].[IsSuppressed] = @isSuppressed
LIMIT @take

12:55:40.560  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002938

12:55:40.571  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006055. Rows Count: 0.

12:55:40.571  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:40.571  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002646

12:55:40.571  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Class  -- Byte
SET     @Class = 1
DECLARE @Type NVarChar(13) -- String
SET     @Type = 'OS Commanding'
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @State  -- Byte
SET     @State = 1
DECLARE @IsSuppressed  -- Boolean
SET     @IsSuppressed = 0
DECLARE @Count  -- Int32
SET     @Count = 0
DECLARE @Id  -- Guid
SET     @Id = X'6B6D753E3460E4428DC3AFF14223A9A0'

UPDATE
	[IssueStatisticEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Class] = @Class,
	[Type] = @Type,
	[Level] = @Level,
	[State] = @State,
	[IsSuppressed] = @IsSuppressed,
	[Count] = @Count
WHERE
	[IssueStatisticEntity].[Id] = @Id

12:55:40.571  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0008151. Records Affected: 1.

12:55:40.571  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010462. Rows Count: 0.

12:55:40.571  TRACE  BeforeExecute
CommitTransactionAsync
12:55:40.571  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0091242

12:55:40.571  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @issueType  -- Byte
SET     @issueType = 1
DECLARE @type NVarChar(13) -- String
SET     @type = 'OS Commanding'
DECLARE @level  -- Byte
SET     @level = 40
DECLARE @state  -- Byte
SET     @state = 2
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Class],
	[x].[Type],
	[x].[Level],
	[x].[State],
	[x].[IsSuppressed],
	[x].[Count]
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] = @id AND
	[x].[Class] = @issueType AND
	[x].[Type] = @type AND
	[x].[Level] = @level AND
	[x].[State] = @state AND
	[x].[IsSuppressed] = @isSuppressed
LIMIT @take

12:55:40.571  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003654

12:55:40.571  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007442. Rows Count: 0.

12:55:40.571  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:40.571  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002449

12:55:40.571  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'
DECLARE @Class  -- Byte
SET     @Class = 1
DECLARE @Type NVarChar(13) -- String
SET     @Type = 'OS Commanding'
DECLARE @Level  -- Byte
SET     @Level = 40
DECLARE @State  -- Byte
SET     @State = 2
DECLARE @IsSuppressed  -- Boolean
SET     @IsSuppressed = 0
DECLARE @Count  -- Int32
SET     @Count = 1
DECLARE @Id  -- Guid
SET     @Id = X'A0C57CE0EC798D4DAC13646C6BC3B346'

UPDATE
	[IssueStatisticEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Class] = @Class,
	[Type] = @Type,
	[Level] = @Level,
	[State] = @State,
	[IsSuppressed] = @IsSuppressed,
	[Count] = @Count
WHERE
	[IssueStatisticEntity].[Id] = @Id

12:55:40.571  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0008275. Records Affected: 1.

12:55:40.571  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010375. Rows Count: 0.

12:55:40.571  TRACE  BeforeExecute
CommitTransactionAsync
12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0065312

12:55:40.591  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002618

12:55:40.591  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002881

12:55:40.591  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005430. Rows Count: 2.

12:55:40.591  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002249

12:55:40.591  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004285. Rows Count: 5.

12:55:40.591  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003456

12:55:40.591  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006061. Rows Count: 1.

12:55:40.591  TRACE  BeforeExecute
DisposeTransactionAsync
12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001966

12:55:40.591  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0

SELECT
	[x].[ScanResultId],
	[x].[Level],
	Sum([x].[Count])
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	[x].[State] <> 2 AND [x].[IsSuppressed] = @isSuppressed
GROUP BY
	[x].[ScanResultId],
	[x].[Level]

12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002872

12:55:40.591  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006031. Rows Count: 3.

12:55:40.591  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002310

12:55:40.591  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002777

12:55:40.591  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004923. Rows Count: 2.

12:55:40.591  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002246

12:55:40.591  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004296. Rows Count: 5.

12:55:40.591  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002879

12:55:40.591  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005051. Rows Count: 1.

12:55:40.591  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 6
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002389. Records Affected: 1.

12:55:40.591  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004216. Rows Count: 0.

12:55:40.591  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(16) -- String
SET     @ScanDurationRaw = '00:00:13.2435851'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 1
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 3
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 2
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 6
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 6
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 5
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007728. Records Affected: 1.

12:55:40.591  TRACE  Total Execution Time (Completed) (async): 00:00:00.0011281. Rows Count: 0.

12:55:40.591  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'D2F453435946464080D096152006C012'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'7E27BACA8700E842B6843C893D9F7AF9'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-15 06:49:34.797'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005984. Records Affected: 1.

12:55:40.591  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008225. Rows Count: 0.

12:55:40.591  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'7C3D07765584C144BEF89AC491C5B37A'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:55:40.591  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004484. Records Affected: 1.

12:55:40.591  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006380. Rows Count: 0.

12:55:40.591  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'07DD07BB114F2E4FA57A9F06B1DD414F'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002072. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004080. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'4DFCE0FD16B085419AAC935BD99183A1'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002753. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005304. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4DFCE0FD16B085419AAC935BD99183A1'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003320. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005156. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'B343746E2B998F48869EE6AA67134EB6'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002036. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003895. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B343746E2B998F48869EE6AA67134EB6'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002245. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004041. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'F9AAB51C21C4B24E9746636F36C46F71'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002270. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004221. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'F9AAB51C21C4B24E9746636F36C46F71'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001942. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003669. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'AC6D23934495BC45854D37B2613D0F3B'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002034. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003853. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'AC6D23934495BC45854D37B2613D0F3B'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001914. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003647. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'FFF7E86A95D8EC439963A85D1D54B247'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002813. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004575. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'11EEA74BCC419E4281D01FCACE2DE3A0'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001803. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003484. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'CCB8349813D5064090435FE7746F7541'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001763. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003427. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'A133B4DDB7110F45B64843DF18B24EBC'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001744. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003587. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'610989587E7B004D80ABCADC8DB237C6'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001736. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003406. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9BFB522C99E2BB42ADE1EC16C4E97B61'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002003. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004032. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'668807753659C4499182008142F4C612'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001859. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003545. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'8E3D46F6A8EEAB4DAD358BD386EA25E6'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001893. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003586. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'AE6DB619325B144B849EFF546BF7509C'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001902. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003588. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'F2EA4573A2606B4A8D2A693318521CFD'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'D2F453435946464080D096152006C012'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001852. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003506. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'07DD07BB114F2E4FA57A9F06B1DD414F'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'D2F453435946464080D096152006C012'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

12:55:40.603  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002214. Records Affected: 1.

12:55:40.603  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004813. Rows Count: 0.

12:55:40.603  TRACE  BeforeExecute
CommitTransactionAsync
12:55:40.623  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0092702

12:55:40.623  TRACE  Send message {EnqueueScanDeltaRecieved, 5669769a-8cfe-4a96-811d-536887bdebde, Json, 244 bytes}.
12:55:40.623  TRACE  Send message {IssueStateUpdated, ee11c13d-64fe-4d41-9992-d093001f1e91, Json, 7 bytes}.
12:55:40.646  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[issue].[IssueHash],
	[issue].[AssistantTipEntityId],
	[issue].[Status]
FROM
	[AssistantTipIssueEntity] [issue]
WHERE
	[issue].[IssueHash] IN ('TB5sxMTpY0YN/dVrsvJREu576PY=')

12:55:40.646  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007171

12:55:40.646  TRACE  Total Execution Time (Completed) (async): 00:00:00.0012793. Rows Count: 1.

12:55:40.646  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:55:40.646  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002886

12:55:40.646  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [tip]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [tip].[Id] = [detail].[AssistantTipEntityId]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:40.649  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002283

12:55:40.649  TRACE  Total Execution Time (Completed): 00:00:00.0005149. Rows Count: 3.

12:55:40.649  TRACE  BeforeExecute
DisposeTransaction
12:55:40.649  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001867

12:55:40.649  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[tip].[Type],
	[tip].[State],
	[tip].[Metadata],
	[tip].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [tip]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:40.649  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002382

12:55:40.649  TRACE  Total Execution Time (Completed): 00:00:00.0004707. Rows Count: 1.

12:55:40.649  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:55:40.649  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002672

12:55:40.649  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:40.649  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002851

12:55:40.649  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005090. Rows Count: 2.

12:55:40.649  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:40.649  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002807

12:55:40.649  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004932. Rows Count: 5.

12:55:40.649  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

12:55:40.649  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003094

12:55:40.649  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005319. Rows Count: 0.

12:55:40.649  TRACE  BeforeExecute
DisposeTransactionAsync
12:55:40.649  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001789

12:55:40.649  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:40.649  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002573

12:55:40.649  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004640. Rows Count: 1.

12:55:40.649  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

12:55:40.649  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002974

12:55:40.649  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004875. Rows Count: 1.

12:55:40.649  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'D2F453435946464080D096152006C012') OR [x].[ObsoleteInScanResultId] IS NULL))

12:55:40.649  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002618

12:55:40.649  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005642. Rows Count: 7.

12:55:40.649  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:55:40.649  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004331

12:55:40.649  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

12:55:40.649  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002110

12:55:40.649  TRACE  Total Execution Time (Completed): 00:00:00.0004047. Rows Count: 3.

12:55:40.649  TRACE  BeforeExecute
DisposeTransaction
12:55:40.649  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001954

12:55:40.649  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

12:55:40.649  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002357

12:55:40.649  TRACE  Total Execution Time (Completed): 00:00:00.0004183. Rows Count: 1.

12:55:40.649  TRACE  Send message {AssistantNotification, 0b28250b-c9e2-4cdb-846b-df5a26ae9176, Json, 171 bytes}.
12:55:40.649  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[issue].[IssueHash],
	[issue].[AssistantTipEntityId],
	[issue].[Status]
FROM
	[AssistantTipIssueEntity] [issue]
WHERE
	[issue].[IssueHash] IN ('TB5sxMTpY0YN/dVrsvJREu576PY=')

12:55:40.649  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005532

12:55:40.649  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010471. Rows Count: 1.

12:55:40.649  TRACE  BeforeExecute
BeginTransaction(Serializable)
12:55:40.649  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002569

12:55:40.649  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [tip]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [tip].[Id] = [detail].[AssistantTipEntityId]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:40.649  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002241

12:55:40.649  TRACE  Total Execution Time (Completed): 00:00:00.0004898. Rows Count: 3.

12:55:40.649  TRACE  BeforeExecute
DisposeTransaction
12:55:40.649  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001988

12:55:40.649  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[tip].[Type],
	[tip].[State],
	[tip].[Metadata],
	[tip].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [tip]
WHERE
	[tip].[Id] IN (X'5C7724E89AA95049AFA5C774CA836028')

12:55:40.665  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002440

12:55:40.665  TRACE  Total Execution Time (Completed): 00:00:00.0004785. Rows Count: 1.

12:55:40.665  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
12:55:40.665  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002883

12:55:40.665  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

12:55:40.665  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002836

12:55:40.665  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004988. Rows Count: 2.

12:55:40.665  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

12:55:40.665  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002920

12:55:40.665  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005020. Rows Count: 5.

12:55:40.665  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

12:55:40.665  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003619

12:55:40.665  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005887. Rows Count: 0.

12:55:40.665  TRACE  BeforeExecute
DisposeTransactionAsync
12:55:40.665  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001882

12:55:40.665  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

12:55:40.665  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002651

12:55:40.665  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004747. Rows Count: 1.

12:55:40.665  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'D2F453435946464080D096152006C012'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-15 06:49:34.797'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

12:55:40.665  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002647

12:55:40.665  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004759. Rows Count: 1.

12:55:40.665  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'D2F453435946464080D096152006C012') OR [x].[ObsoleteInScanResultId] IS NULL))

12:55:40.665  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002590

12:55:40.665  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005514. Rows Count: 7.

12:55:40.665  TRACE  Receive message {UpdateIssueState, ee11c13d-64fe-4d41-9992-d093001f1e91, Json, 134 bytes}.
