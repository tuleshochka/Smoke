14:38:47.919   INFO  infrastructure starting
14:38:47.985  TRACE  Waiting for an infrastructure initialization message.
14:38:48.070  DEBUG  Initiating infrastructure provisioning.
14:38:48.361  TRACE  Run for execution "C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils\descriptionsService\AI.Descriptions.HostedService.exe" in job "job-2253b771-c74b-4ed0-a0b9-ce6e79a16e9d". Start parameters: " --port 5008 --feed-folder "C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\feeds" --log-path "C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Logs\Infrastructure\2024-11-20-14-38-47\descriptionsService.log " --log-level Trace".
14:38:48.380  TRACE  Process successful started with pid 8492.
14:38:48.380  TRACE  Waiting for exit of process with pid 8492.
14:38:48.388  TRACE  update feeds started
14:38:48.388  TRACE  Attempt send update feeds request to service
14:38:48.434   INFO  There are 1 suitable migrations
14:38:48.434  DEBUG  Version '2.3.1' with 2 stage(s)
14:38:48.434   INFO  Migration to '2.3.1' version start
14:38:48.434   INFO  Migration to '2.3.1' version success complete
14:38:48.563  TRACE  Send message {Initialized, 3893c87c-a6c2-4641-81fc-b0c4ecb0a9be, Json, 7 bytes}.
14:38:48.590   INFO  Wait transport disconnecting
14:38:48.590  TRACE  Receive message {Initialize, 3893c87c-a6c2-4641-81fc-b0c4ecb0a9be, Json, 1144 bytes}.
14:38:48.762  TRACE  Send message {IssueDescriptions, f32f9e0c-83b6-3f45-9b1d-77c0ef0ffaaf, Json, 1186979 bytes}.
14:38:48.762  TRACE  Receive message {GetIssueDescriptions, f32f9e0c-83b6-3f45-9b1d-77c0ef0ffaaf, Json, 0 bytes}.
14:38:49.600  TRACE  Send message {Projects, 0af83a25-b0e7-a649-a375-4f7803a42587, Json, 244 bytes}.
14:38:49.604  TRACE  Receive message {GetProjects, 0af83a25-b0e7-a649-a375-4f7803a42587, Json, 0 bytes}.
14:38:49.713  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
14:38:49.713  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0012406

14:38:49.713  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:38:49.728  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0048352

14:38:49.728  TRACE  Total Execution Time (Completed) (async): 00:00:00.0205239. Rows Count: 2.

14:38:49.728  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:38:49.728  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005493

14:38:49.752  TRACE  Total Execution Time (Completed) (async): 00:00:00.0119863. Rows Count: 5.

14:38:49.752  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

14:38:49.752  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0011072

14:38:49.763  TRACE  Total Execution Time (Completed) (async): 00:00:00.0091610. Rows Count: 0.

14:38:49.763  TRACE  BeforeExecute
DisposeTransactionAsync
14:38:49.763  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007229

14:38:49.763  DEBUG  Scan result ID: f747eeb6-122f-4bde-8b51-bb751dda6b76
14:38:49.781  TRACE  Send message {ScanResult, 01f670c7-d1be-974f-8ba0-c4af271926b8, Json, 1265 bytes}.
14:38:49.792  TRACE  BeforeExecute
BeginTransaction(Serializable)
14:38:49.792  TRACE  Query Execution Time (AfterExecute): 00:00:00.0005627

14:38:49.792  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

14:38:49.792  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003967

14:38:49.792  TRACE  Total Execution Time (Completed): 00:00:00.0029742. Rows Count: 3.

14:38:49.792  TRACE  BeforeExecute
DisposeTransaction
14:38:49.792  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002804

14:38:49.792  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

14:38:49.792  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003568

14:38:49.792  TRACE  Total Execution Time (Completed): 00:00:00.0033161. Rows Count: 1.

14:38:49.792  TRACE  Send message {AssistantNotification, b7fad931-5169-4c6c-9fd3-172f6b964011, Json, 172 bytes}.
14:38:49.809  TRACE  BeforeExecute
BeginTransaction(Serializable)
14:38:49.809  TRACE  Query Execution Time (AfterExecute): 00:00:00.0005876

14:38:49.809  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

14:38:49.809  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002365

14:38:49.809  TRACE  Total Execution Time (Completed): 00:00:00.0004599. Rows Count: 3.

14:38:49.809  TRACE  BeforeExecute
DisposeTransaction
14:38:49.809  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001723

14:38:49.809  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

14:38:49.809  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002198

14:38:49.809  TRACE  Total Execution Time (Completed): 00:00:00.0004165. Rows Count: 1.

14:38:49.824  TRACE  Send message {AssistantNotification, 8323959e-3a82-4612-a51e-a8396acc38ed, Json, 80 bytes}.
14:38:49.824  TRACE  Receive message {GetLastScanResult, 01f670c7-d1be-974f-8ba0-c4af271926b8, Json, 38 bytes}.
14:38:49.824  TRACE  Send message {EnterpriseIntegrationInfo, 4a4959a4-a600-1145-88b9-acb27bfcc234, Json, 110 bytes}.
14:38:49.824  TRACE  Receive message {EnterpriseGetState, 4a4959a4-a600-1145-88b9-acb27bfcc234, Json, 0 bytes}.
14:38:49.852  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
14:38:49.852  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005640

14:38:49.853  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_VfsEntity].[Id],
	[detail].[VfsId],
	[detail].[NodePath],
	[detail].[PhysicalPath],
	[detail].[MaxIssueLevel],
	[detail].[ScanByCores],
	[detail].[ScanningByCores],
	[detail].[ScannedByCores],
	[detail].[NodeType],
	[detail].[IncludeInScan],
	[detail].[LifeTimeStatus],
	[detail].[LastModifiedDate],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[Id]
		FROM
			(
				SELECT
					[x].[Id]
				FROM
					[VfsEntity] [x]
				WHERE
					[x].[ScanResultId] = @id
				LIMIT @take
			) [t1]
	) [lw_VfsEntity]
		INNER JOIN [VfsNodeEntity] [detail] ON [lw_VfsEntity].[Id] = [detail].[VfsId]

14:38:49.853  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005255

14:38:49.853  TRACE  Total Execution Time (Completed) (async): 00:00:00.0045567. Rows Count: 14.

14:38:49.853  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[RootNodePath]
FROM
	[VfsEntity] [x]
WHERE
	[x].[ScanResultId] = @id
LIMIT @take

14:38:49.853  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003860

14:38:49.853  TRACE  Total Execution Time (Completed) (async): 00:00:00.0020314. Rows Count: 0.

14:38:49.853  TRACE  BeforeExecute
DisposeTransactionAsync
14:38:49.853  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002268

14:38:49.884  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
14:38:49.884  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004378

14:38:49.884  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:38:49.884  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003819

14:38:49.884  TRACE  Total Execution Time (Completed) (async): 00:00:00.0017877. Rows Count: 2.

14:38:49.884  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:38:49.884  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003245

14:38:49.884  TRACE  Total Execution Time (Completed) (async): 00:00:00.0017520. Rows Count: 5.

14:38:49.884  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:38:49.884  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004140

14:38:49.884  TRACE  Total Execution Time (Completed) (async): 00:00:00.0048250. Rows Count: 1.

14:38:49.884  TRACE  BeforeExecute
DisposeTransactionAsync
14:38:49.884  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003136

14:38:49.901  TRACE  Send message {ScanResultVFS, a0d071d2-80c8-3a44-bc9d-ad6231fd0d1e, Json, 4632 bytes}.
14:38:49.901  TRACE  Receive message {GetScanResultVFS, a0d071d2-80c8-3a44-bc9d-ad6231fd0d1e, Json, 106 bytes}.
14:38:49.901  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:38:50.501  DEBUG  Send GET request https://aie-ub2210-41377.aie.ptsecurity.ru/api/auth/currentTime with Id 8eeb16e5-c7be-498e-9a33-c80cccfb3c16
14:38:51.236  DEBUG  Send POST request https://aie-ub2210-41377.aie.ptsecurity.ru/api/auth/validateToken with Id 4805ce6a-620e-4d8f-9f01-0d769ebcf420
14:38:51.236  TRACE  Request with Id 4805ce6a-620e-4d8f-9f01-0d769ebcf420 body 
14:38:51.453  DEBUG  Send GET request https://aie-ub2210-41377.aie.ptsecurity.ru/api/auth/currentTime with Id ecd3d045-6cc2-451d-9ac7-b89b9f6ddfb6
14:38:51.453  DEBUG  Send GET request https://aie-ub2210-41377.aie.ptsecurity.ru/api/auth/currentTime with Id 92bc9b86-aea2-409e-88b6-0fd99b0c8f6e
14:38:51.943  DEBUG  Send POST request https://aie-ub2210-41377.aie.ptsecurity.ru/api/auth/validateToken with Id 0143861d-87ba-4f5f-aa70-466fd109f208
14:38:51.943  TRACE  Request with Id 0143861d-87ba-4f5f-aa70-466fd109f208 body 
14:38:52.133  DEBUG  Start notification client reconfiguration
14:38:52.134  DEBUG  Send GET request https://aie-ub2210-41377.aie.ptsecurity.ru/api/auth/currentTime with Id 532e159e-03c4-4daf-9122-10d4f14b2d70
14:38:52.389  DEBUG  Send POST request https://aie-ub2210-41377.aie.ptsecurity.ru/api/auth/validateToken with Id 54828c9b-a5de-4e80-9829-c74cdb834535
14:38:52.389  TRACE  Request with Id 54828c9b-a5de-4e80-9829-c74cdb834535 body 
14:38:54.033  DEBUG  Success connect to notifications service. ClientId: eb60a58e-dcab-4b68-857e-9d4e1b88254c
14:38:54.033  DEBUG  Subscribe on notification 'IssuesUpdated'
14:38:54.054  DEBUG  Subscribe on notification 'ProjectMembersChangePermission'
14:38:54.054  DEBUG  Subscribe on notification 'GlobalMembersChangePermission'
14:38:54.054  DEBUG  Subscribe on notification 'ScanCompleted'
14:38:54.057  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:38:54.057  TRACE  Send message {EnterpriseIntegrationInfo, beeb35ec-c3c1-b443-901d-7c40258d91e7, Json, 109 bytes}.
14:38:54.057  TRACE  Receive message {TryInitializeEnterpriseIntegration, beeb35ec-c3c1-b443-901d-7c40258d91e7, Json, 0 bytes}.
14:38:54.057  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

14:38:54.057  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005211

14:38:54.057  TRACE  Total Execution Time (Completed) (async): 00:00:00.0025947. Rows Count: 1.

14:38:54.083  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-20 08:37:18.934'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

14:38:54.083  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0011064

14:38:54.083  TRACE  Total Execution Time (Completed) (async): 00:00:00.0068621. Rows Count: 1.

14:38:54.112  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'B6EE47F72F12DE4B8B51BB751DDA6B76') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'B6EE47F72F12DE4B8B51BB751DDA6B76') OR [x].[ObsoleteInScanResultId] IS NULL))

14:38:54.112  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005606

14:38:54.112  TRACE  Total Execution Time (Completed) (async): 00:00:00.0069528. Rows Count: 7.

14:38:54.193  TRACE  Send message {Issues, 8852e884-e9d7-7d40-99b5-f9bc28df73a5, Json, 10934 bytes}.
14:38:54.193  TRACE  Receive message {GetIssues, 8852e884-e9d7-7d40-99b5-f9bc28df73a5, Json, 106 bytes}.
14:38:54.198  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:38:54.198  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004740

14:38:54.213  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [t1]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [t1].[Id] = [a_ScanEnvironment].[ScanResultId]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:38:54.213  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004813

14:38:54.213  TRACE  Total Execution Time (Completed): 00:00:00.0023169. Rows Count: 54.

14:38:54.213  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [t1]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [t1].[Id] = [a_ScanEnvironment].[ScanResultId]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:38:54.213  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003115

14:38:54.213  TRACE  Total Execution Time (Completed): 00:00:00.0019054. Rows Count: 135.

14:38:54.213  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[ScanChainId],
	[t1].[ProjectId],
	[t1].[SettingsId],
	[t1].[Version],
	[t1].[ScanDate],
	[t1].[PreviousScanResultId],
	[t1].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [t1]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [t1].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [t1].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [t1].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]

14:38:54.213  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004307

14:38:54.213  TRACE  Total Execution Time (Completed): 00:00:00.0054460. Rows Count: 27.

14:38:54.213  TRACE  BeforeExecute
DisposeTransactionAsync
14:38:54.213  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003082

14:38:54.213  TRACE  Send message {CleanUpScanResultsDone, 97799ccb-970e-eb4a-bed1-29f34bd7702b, Json, 7 bytes}.
14:38:54.213  TRACE  Receive message {CleanUpScanResults, 97799ccb-970e-eb4a-bed1-29f34bd7702b, Json, 77 bytes}.
14:38:54.213  DEBUG  Send GET request https://aie-ub2210-41377.aie.ptsecurity.ru/api/versions/server/current with Id 4f473c41-8a63-4bfd-bf5a-3baa9b77a3d2
14:38:54.693  TRACE  Send message {EnterpriseServerVersion, e90ab83e-cbc1-984b-ad88-a49fe992a84f, Json, 38 bytes}.
14:38:54.693  TRACE  Receive message {EnterpriseGetServerVersion, e90ab83e-cbc1-984b-ad88-a49fe992a84f, Json, 0 bytes}.
14:38:54.712  TRACE  BeforeExecute
BeginTransaction(Serializable)
14:38:54.712  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004856

14:38:54.712  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [x]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		WHERE
			[x].[ProjectId] = @id
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:38:54.712  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004374

14:38:54.712  TRACE  Total Execution Time (Completed): 00:00:00.0022163. Rows Count: 54.

14:38:54.712  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [x]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		WHERE
			[x].[ProjectId] = @id
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:38:54.712  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003719

14:38:54.712  TRACE  Total Execution Time (Completed): 00:00:00.0017590. Rows Count: 135.

14:38:54.712  TRACE  BeforeExecute
DisposeTransaction
14:38:54.712  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001902

14:38:54.712  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id

14:38:54.712  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004686

14:38:54.712  TRACE  Total Execution Time (Completed): 00:00:00.0058230. Rows Count: 27.

14:38:54.746  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0

SELECT
	[x].[ScanResultId],
	[x].[Level],
	Sum([x].[Count])
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012', X'D2FF306FE261B347A98B069FF6F38FD8', X'2B48D224BE15B84895856654FFC85A82', X'6E1D86CCE2158D4692F5076934142B7B', X'60D7A0EDABF5B84DB280DFCE68C72FB4', X'F1B0EE936CED3540B93599D03134D172', X'16E10E710FB5934081214C3BA30B8EFE', X'D7D0217956190543A78DA2AEB0E3C237', X'8616037631220149B228EEEFBF54E99F', X'215A0B01AF8A3247AD7D1EE61880DCB9', X'F22EB2478F941E4693F383DC0727774E', X'FA8670DCAC560241B045EFA60891B99A', X'F71B58EAFF356B44AE15261CD1BF0291', X'A7274C855838654BBA1F3E35CBD02112', X'B288F43634AD68498179DC9F0AC7A0BB', X'9024BE052328344E8D1307B28CE9F75A', X'739F61611F430B4DA53EA3DE2BC9C967', X'4E085DF691E76C4AAC086198DC5C33EA', X'561C96D2A5ED82429CB0D2CC0E568434', X'9F8B13F0247FF949B653622AB6FE8278', X'AB517C3AA8D0B647AA9F9F9E8A695F1F', X'7DCBC03C1024634F808AF616F584639A', X'36C62EA3EE19F445AF294969CAF0F2EA', X'6090BFD4D56AAA4E827806320578DCA7', X'8DD6A069D24CCA4EABF927939C9D548C', X'AEA4774896EC7A4A9A99043CB8925CB5', X'B6EE47F72F12DE4B8B51BB751DDA6B76') AND
	[x].[State] <> 2 AND [x].[IsSuppressed] = @isSuppressed
GROUP BY
	[x].[ScanResultId],
	[x].[Level]

14:38:54.746  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007259

14:38:54.746  TRACE  Total Execution Time (Completed) (async): 00:00:00.0023903. Rows Count: 63.

14:38:54.768  TRACE  Send message {ScanResults, 3fa0fcc6-5046-1f43-ad50-7e7134983b1f, Json, 34345 bytes}.
14:38:54.768  TRACE  BeforeExecute
BeginTransaction(Serializable)
14:38:54.768  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004196

14:38:54.768  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

14:38:54.768  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002242

14:38:54.768  TRACE  Total Execution Time (Completed): 00:00:00.0004465. Rows Count: 3.

14:38:54.768  TRACE  BeforeExecute
DisposeTransaction
14:38:54.768  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001607

14:38:54.768  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

14:38:54.768  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002066

14:38:54.768  TRACE  Total Execution Time (Completed): 00:00:00.0004127. Rows Count: 1.

14:38:54.768  TRACE  Send message {AssistantNotification, 72fc00cf-84ef-4f64-b300-fe30ddffedf5, Json, 172 bytes}.
14:38:54.768  TRACE  BeforeExecute
BeginTransaction(Serializable)
14:38:54.768  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004146

14:38:54.768  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

14:38:54.768  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003585

14:38:54.768  TRACE  Total Execution Time (Completed): 00:00:00.0006599. Rows Count: 3.

14:38:54.768  TRACE  BeforeExecute
DisposeTransaction
14:38:54.774  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001796

14:38:54.774  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

14:38:54.774  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003613

14:38:54.774  TRACE  Total Execution Time (Completed): 00:00:00.0006111. Rows Count: 1.

14:38:54.774  TRACE  Send message {AssistantNotification, dc8a8b65-c5c1-45a6-9eb6-b73683072536, Json, 80 bytes}.
14:38:54.774  TRACE  Receive message {GetScanResults, 3fa0fcc6-5046-1f43-ad50-7e7134983b1f, Json, 38 bytes}.
14:38:54.774  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @localProjectId  -- Guid
SET     @localProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[LocalProjectId],
	[x].[AieProjectId],
	[x].[MappedDateTime],
	[x].[SynchronizationType],
	[x].[ShouldSynchronizeStatuses]
FROM
	[LocalToAieProjectsMapEntity] [x]
WHERE
	[x].[LocalProjectId] = @localProjectId
LIMIT @take

14:38:54.774  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006020

14:38:54.774  TRACE  Total Execution Time (Completed) (async): 00:00:00.0040212. Rows Count: 1.

14:38:54.774  DEBUG  synchronization after map was skipped
14:38:54.791  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
14:38:54.791  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004600

14:38:54.791  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:38:54.791  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005149

14:38:54.791  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008506. Rows Count: 2.

14:38:54.791  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:38:54.791  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002999

14:38:54.791  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005660. Rows Count: 5.

14:38:54.791  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

14:38:54.791  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003996

14:38:54.791  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006555. Rows Count: 0.

14:38:54.791  TRACE  BeforeExecute
DisposeTransactionAsync
14:38:54.791  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001734

14:38:54.791  DEBUG  Send GET request https://aie-ub2210-41377.aie.ptsecurity.ru/api/projects/f8e50bef-301d-43ef-8c4f-e8a8ed4ed789/scanResults with Id 8f2258c8-d534-4875-ba3c-5b68d97690a8
14:38:55.382  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

14:38:55.382  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004707

14:38:55.382  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007769. Rows Count: 1.

14:38:55.382  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-20 08:37:18.934'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

14:38:55.384  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003208

14:38:55.384  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005338. Rows Count: 1.

14:38:55.384  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'B6EE47F72F12DE4B8B51BB751DDA6B76') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'B6EE47F72F12DE4B8B51BB751DDA6B76') OR [x].[ObsoleteInScanResultId] IS NULL))

14:38:55.384  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002546

14:38:55.384  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006550. Rows Count: 7.

14:38:55.384  DEBUG  Send GET request https://aie-ub2210-41377.aie.ptsecurity.ru/api/projects/f8e50bef-301d-43ef-8c4f-e8a8ed4ed789/scanResults/8065c276-9099-4b18-a959-3b6a395662c7/issues with Id 2da02b05-a462-4c4c-bb29-f28486fd9577
14:38:55.733  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:38:55.733  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004212

14:38:55.780  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @Key NVarChar(28) -- String
SET     @Key = 'ni2vcNHuysjqSYwMgdBNDroX3mk='
DECLARE @IssueType  -- Byte
SET     @IssueType = 1
DECLARE @ApprovalState  -- Byte
SET     @ApprovalState = 2
DECLARE @Level  -- Byte
SET     @Level = 30
DECLARE @ObsoleteInScanResultId  -- Guid
SET     @ObsoleteInScanResultId = NULL
DECLARE @IsNewInScanResultId  -- Guid
SET     @IsNewInScanResultId = X'B288F43634AD68498179DC9F0AC7A0BB'
DECLARE @Language  -- Int32
SET     @Language = 1
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Data Binary(2287)
SET     @Data = X'DE0024A672767050766FC0A969737375655479706501AA696E7465726E616C4964D92437386231333561612D376630352D343230322D623139302D343335383834386532616230A26964BC6E693276634E487579736A715359774D6764424E44726F5833'
-- value above truncated for logging
DECLARE @Id  -- Guid
SET     @Id = X'AA35B178057F0242B1904358848E2AB0'

UPDATE
	[IssueEntity]
SET
	[ScanResultId] = @ScanResultId,
	[Key] = @Key,
	[IssueType] = @IssueType,
	[ApprovalState] = @ApprovalState,
	[Level] = @Level,
	[ObsoleteInScanResultId] = @ObsoleteInScanResultId,
	[IsNewInScanResultId] = @IsNewInScanResultId,
	[Language] = @Language,
	[ScanAppType] = @ScanAppType,
	[Data] = @Data
WHERE
	[IssueEntity].[Id] = @Id

14:38:55.793  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0142559. Records Affected: 1.

14:38:55.793  TRACE  Total Execution Time (Completed) (async): 00:00:00.0173521. Rows Count: 0.

14:38:55.793  DEBUG  Issue ID: 78b135aa-7f05-4202-b190-4358848e2ab0 Links count: 0
14:38:55.793  TRACE  BeforeExecute
CommitTransactionAsync
14:38:55.793  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0088256

14:38:55.814  TRACE  Send message {IssuesUpdatedData, dd87519b-33d7-4668-b4d6-2a60a531bec7, Json, 467 bytes}.
14:38:55.831  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[issue].[IssueHash],
	[issue].[AssistantTipEntityId],
	[issue].[Status]
FROM
	[AssistantTipIssueEntity] [issue]
WHERE
	[issue].[IssueHash] IN ('ni2vcNHuysjqSYwMgdBNDroX3mk=')

14:38:55.831  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006592

14:38:55.831  TRACE  Total Execution Time (Completed) (async): 00:00:00.0012406. Rows Count: 0.

14:38:55.841  TRACE  BeforeExecute
BeginTransaction(Serializable)
14:38:55.841  TRACE  Query Execution Time (AfterExecute): 00:00:00.0006878

14:38:55.841  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [tip]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [tip].[Id] = [detail].[AssistantTipEntityId]
WHERE
	1 = 0

14:38:55.841  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004225

14:38:55.841  TRACE  Total Execution Time (Completed): 00:00:00.0015474. Rows Count: 0.

14:38:55.841  TRACE  BeforeExecute
DisposeTransaction
14:38:55.841  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003465

14:38:55.841  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[tip].[Type],
	[tip].[State],
	[tip].[Metadata],
	[tip].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [tip]
WHERE
	1 = 0

14:38:55.841  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004732

14:38:55.841  TRACE  Total Execution Time (Completed): 00:00:00.0009959. Rows Count: 0.

14:38:55.841  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
14:38:55.841  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004665

14:38:55.841  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:38:55.841  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005697

14:38:55.841  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010146. Rows Count: 2.

14:38:55.841  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:38:55.841  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004965

14:38:55.841  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010376. Rows Count: 5.

14:38:55.841  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

14:38:55.841  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0008369

14:38:55.841  TRACE  Total Execution Time (Completed) (async): 00:00:00.0013438. Rows Count: 0.

14:38:55.841  TRACE  BeforeExecute
DisposeTransactionAsync
14:38:55.841  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003507

14:38:55.841  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

14:38:55.853  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005669

14:38:55.853  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009627. Rows Count: 1.

14:38:55.853  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-20 08:37:18.934'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

14:38:55.853  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005844

14:38:55.853  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009651. Rows Count: 1.

14:38:55.853  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'B6EE47F72F12DE4B8B51BB751DDA6B76') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'B6EE47F72F12DE4B8B51BB751DDA6B76') OR [x].[ObsoleteInScanResultId] IS NULL))

14:38:55.853  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004989

14:38:55.853  TRACE  Total Execution Time (Completed) (async): 00:00:00.0013163. Rows Count: 7.

14:38:55.853  TRACE  BeforeExecute
BeginTransaction(Serializable)
14:38:55.853  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004860

14:38:55.853  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

14:38:55.853  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004165

14:38:55.853  TRACE  Total Execution Time (Completed): 00:00:00.0008043. Rows Count: 3.

14:38:55.853  TRACE  BeforeExecute
DisposeTransaction
14:38:55.853  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003653

14:38:55.853  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

14:38:55.853  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004672

14:38:55.853  TRACE  Total Execution Time (Completed): 00:00:00.0008404. Rows Count: 1.

14:38:55.853  TRACE  Send message {AssistantNotification, cf7c4133-6307-4a78-a7ef-cbd1eda5e99f, Json, 172 bytes}.
14:38:55.853  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[issue].[IssueHash],
	[issue].[AssistantTipEntityId],
	[issue].[Status]
FROM
	[AssistantTipIssueEntity] [issue]
WHERE
	[issue].[IssueHash] IN ('ni2vcNHuysjqSYwMgdBNDroX3mk=')

14:38:55.853  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006726

14:38:55.853  TRACE  Total Execution Time (Completed) (async): 00:00:00.0013490. Rows Count: 0.

14:38:55.853  TRACE  BeforeExecute
BeginTransaction(Serializable)
14:38:55.853  TRACE  Query Execution Time (AfterExecute): 00:00:00.0005246

14:38:55.853  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [tip]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [tip].[Id] = [detail].[AssistantTipEntityId]
WHERE
	1 = 0

14:38:55.853  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004050

14:38:55.868  TRACE  Total Execution Time (Completed): 00:00:00.0008871. Rows Count: 0.

14:38:55.868  TRACE  BeforeExecute
DisposeTransaction
14:38:55.868  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003439

14:38:55.868  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[tip].[Id],
	[tip].[Type],
	[tip].[State],
	[tip].[Metadata],
	[tip].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [tip]
WHERE
	1 = 0

14:38:55.868  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002849

14:38:55.868  TRACE  Total Execution Time (Completed): 00:00:00.0004928. Rows Count: 0.

14:38:55.868  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
14:38:55.868  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002529

14:38:55.868  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:38:55.868  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003078

14:38:55.868  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005343. Rows Count: 2.

14:38:55.868  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[ProjectId] = @id
				ORDER BY
					[x].[ScanDate] DESC
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:38:55.868  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002649

14:38:55.868  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004931. Rows Count: 5.

14:38:55.868  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id
ORDER BY
	[x].[ScanDate] DESC
LIMIT @take

14:38:55.868  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007862

14:38:55.868  TRACE  Total Execution Time (Completed) (async): 00:00:00.0012200. Rows Count: 0.

14:38:55.868  TRACE  BeforeExecute
DisposeTransactionAsync
14:38:55.868  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004132

14:38:55.868  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

14:38:55.868  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005881

14:38:55.868  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010954. Rows Count: 1.

14:38:55.868  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'B6EE47F72F12DE4B8B51BB751DDA6B76'
DECLARE @scanDate  -- DateTime
SET     @scanDate = '2024-11-20 08:37:18.934'

SELECT
	[x].[Id]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[ScanChainId] = @id AND DateTime([x].[ScanDate]) <= DateTime(@scanDate)

14:38:55.868  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005976

14:38:55.868  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010486. Rows Count: 1.

14:38:55.868  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

SELECT
	[x].[Id],
	[x].[ScanResultId],
	[x].[Key],
	[x].[IssueType],
	[x].[ApprovalState],
	[x].[Level],
	[x].[ObsoleteInScanResultId],
	[x].[IsNewInScanResultId],
	[x].[Language],
	[x].[ScanAppType],
	[x].[Data]
FROM
	[IssueEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'B6EE47F72F12DE4B8B51BB751DDA6B76') AND
	([x].[ObsoleteInScanResultId] IS NULL OR ([x].[ObsoleteInScanResultId] NOT IN (X'B6EE47F72F12DE4B8B51BB751DDA6B76') OR [x].[ObsoleteInScanResultId] IS NULL))

14:38:55.868  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004356

14:38:55.868  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010696. Rows Count: 7.

14:38:55.868  TRACE  Send message {EnterpriseProjectMapInfo, fad51b5e-a623-c14b-8051-34f39aacb6cc, Json, 189 bytes}.
14:38:55.883  TRACE  Receive message {EnterpriseInitializeProjectMap, fad51b5e-a623-c14b-8051-34f39aacb6cc, Json, 38 bytes}.
14:38:55.883  TRACE  BeforeExecute
BeginTransaction(Serializable)
14:38:55.883  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004726

14:38:55.883  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [x]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		WHERE
			[x].[ProjectId] = @id
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:38:55.883  TRACE  Query Execution Time (AfterExecute): 00:00:00.0005959

14:38:55.883  TRACE  Total Execution Time (Completed): 00:00:00.0012720. Rows Count: 54.

14:38:55.883  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [x]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		WHERE
			[x].[ProjectId] = @id
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:38:55.883  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004479

14:38:55.883  TRACE  Total Execution Time (Completed): 00:00:00.0013458. Rows Count: 135.

14:38:55.883  TRACE  BeforeExecute
DisposeTransaction
14:38:55.883  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003996

14:38:55.883  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id

14:38:55.883  TRACE  Query Execution Time (AfterExecute): 00:00:00.0007644

14:38:55.883  TRACE  Total Execution Time (Completed): 00:00:00.0022355. Rows Count: 27.

14:38:55.883  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @isSuppressed  -- Boolean
SET     @isSuppressed = 0

SELECT
	[x].[ScanResultId],
	[x].[Level],
	Sum([x].[Count])
FROM
	[IssueStatisticEntity] [x]
WHERE
	[x].[ScanResultId] IN (X'D2F453435946464080D096152006C012', X'D2FF306FE261B347A98B069FF6F38FD8', X'2B48D224BE15B84895856654FFC85A82', X'6E1D86CCE2158D4692F5076934142B7B', X'60D7A0EDABF5B84DB280DFCE68C72FB4', X'F1B0EE936CED3540B93599D03134D172', X'16E10E710FB5934081214C3BA30B8EFE', X'D7D0217956190543A78DA2AEB0E3C237', X'8616037631220149B228EEEFBF54E99F', X'215A0B01AF8A3247AD7D1EE61880DCB9', X'F22EB2478F941E4693F383DC0727774E', X'FA8670DCAC560241B045EFA60891B99A', X'F71B58EAFF356B44AE15261CD1BF0291', X'A7274C855838654BBA1F3E35CBD02112', X'B288F43634AD68498179DC9F0AC7A0BB', X'9024BE052328344E8D1307B28CE9F75A', X'739F61611F430B4DA53EA3DE2BC9C967', X'4E085DF691E76C4AAC086198DC5C33EA', X'561C96D2A5ED82429CB0D2CC0E568434', X'9F8B13F0247FF949B653622AB6FE8278', X'AB517C3AA8D0B647AA9F9F9E8A695F1F', X'7DCBC03C1024634F808AF616F584639A', X'36C62EA3EE19F445AF294969CAF0F2EA', X'6090BFD4D56AAA4E827806320578DCA7', X'8DD6A069D24CCA4EABF927939C9D548C', X'AEA4774896EC7A4A9A99043CB8925CB5', X'B6EE47F72F12DE4B8B51BB751DDA6B76') AND
	[x].[State] <> 2 AND [x].[IsSuppressed] = @isSuppressed
GROUP BY
	[x].[ScanResultId],
	[x].[Level]

14:38:55.883  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0008555

14:38:55.883  TRACE  Total Execution Time (Completed) (async): 00:00:00.0019418. Rows Count: 63.

14:38:55.902  TRACE  Send message {ScanResults, c95a8abc-89c4-3141-a00e-bbaabf73de35, Json, 34345 bytes}.
14:38:55.902  TRACE  BeforeExecute
BeginTransaction(Serializable)
14:38:55.902  TRACE  Query Execution Time (AfterExecute): 00:00:00.0006958

14:38:55.902  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

14:38:55.902  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002283

14:38:55.902  TRACE  Total Execution Time (Completed): 00:00:00.0004557. Rows Count: 3.

14:38:55.902  TRACE  BeforeExecute
DisposeTransaction
14:38:55.902  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002425

14:38:55.902  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

14:38:55.902  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002624

14:38:55.902  TRACE  Total Execution Time (Completed): 00:00:00.0006847. Rows Count: 1.

14:38:55.902  TRACE  Send message {AssistantNotification, f491c5d0-3066-47fe-a4db-7c6c59e8cb48, Json, 172 bytes}.
14:38:55.902  TRACE  BeforeExecute
BeginTransaction(Serializable)
14:38:55.902  TRACE  Query Execution Time (AfterExecute): 00:00:00.0005482

14:38:55.902  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[lw_AssistantTipEntity].[Id],
	[detail].[IssueHash],
	[detail].[AssistantTipEntityId],
	[detail].[Status]
FROM
	[AssistantTipEntity] [lw_AssistantTipEntity]
		INNER JOIN [AssistantTipIssueEntity] [detail] ON [lw_AssistantTipEntity].[Id] = [detail].[AssistantTipEntityId]

14:38:55.902  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004250

14:38:55.902  TRACE  Total Execution Time (Completed): 00:00:00.0008253. Rows Count: 3.

14:38:55.902  TRACE  BeforeExecute
DisposeTransaction
14:38:55.902  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003432

14:38:55.902  TRACE  BeforeExecute
--  SQLite.MS SQLite

SELECT
	[t1].[Id],
	[t1].[Type],
	[t1].[State],
	[t1].[Metadata],
	[t1].[UniqueIssuesCount]
FROM
	[AssistantTipEntity] [t1]

14:38:55.902  TRACE  Query Execution Time (AfterExecute): 00:00:00.0004464

14:38:55.902  TRACE  Total Execution Time (Completed): 00:00:00.0008580. Rows Count: 1.

14:38:55.902  TRACE  Send message {AssistantNotification, 44725d37-3586-4156-8e1c-ed873cc719a8, Json, 80 bytes}.
14:38:55.902  TRACE  Receive message {GetScanResults, c95a8abc-89c4-3141-a00e-bbaabf73de35, Json, 38 bytes}.
14:38:55.919  DEBUG  Send GET request https://aie-ub2210-41377.aie.ptsecurity.ru/api/auth/users/current with Id 7f71ef77-b8c1-4d3e-bfa1-8f4f8b39b390
14:38:56.413  DEBUG  Send GET request https://aie-ub2210-41377.aie.ptsecurity.ru/api/auth/users/b8722fc5-7437-4c3a-a6a5-683090f3d495/permissions with Id 9f936ab5-efe8-401a-a872-4d59766e375d
14:38:57.007  DEBUG  Send GET request https://aie-ub2210-41377.aie.ptsecurity.ru/api/auth/users/b8722fc5-7437-4c3a-a6a5-683090f3d495/permissions/projects with Id 6ebeaf1a-a3ae-46d8-9e93-64cc2d917c4e
14:38:57.223  TRACE  Send message {EnterpriseUserInfo, 682890ad-5edd-f64e-a02b-9dcb56766414, Json, 823 bytes}.
14:38:57.234  TRACE  Receive message {EnterpriseGetUserInfo, 682890ad-5edd-f64e-a02b-9dcb56766414, Json, 0 bytes}.
14:38:59.575  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:39:00.261  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:39:05.260  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:39:05.888  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:39:10.903  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:39:11.485  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:39:16.496  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:39:17.044  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:39:22.058  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:39:22.592  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:39:27.597  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:39:28.158  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:39:33.159  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:39:33.970  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:39:35.538  TRACE  update feeds completed
14:39:38.985  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:39:39.639  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:39:44.643  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:39:45.225  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:39:50.228  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:39:50.853  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:39:55.856  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:39:56.527  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:40:01.531  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:40:02.012  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:40:07.014  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:40:07.514  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:40:12.524  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:40:13.037  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:40:18.039  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:40:18.492  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:40:23.496  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:40:23.978  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:40:28.978  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:40:29.504  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:40:34.519  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:40:35.070  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:40:40.071  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:40:40.601  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:40:45.616  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:40:46.287  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:40:51.298  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:40:51.879  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:40:56.893  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:40:57.505  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:41:02.518  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:41:03.062  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:41:08.062  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:41:08.580  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:41:13.584  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:41:14.224  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:41:19.227  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:41:19.756  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:41:24.757  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:41:25.151  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:41:30.153  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:41:30.704  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:41:35.711  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:41:36.239  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:41:41.247  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:41:42.131  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:41:47.136  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:41:47.656  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:41:52.666  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:41:53.119  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:41:58.131  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:41:58.652  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:42:03.655  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:42:04.182  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:42:09.196  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:42:09.693  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:42:14.699  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:42:15.233  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:42:20.247  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:42:20.795  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:42:24.125  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9F9E4BA2F658244E9AEF21946A863ADF'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[Data]
FROM
	[SettingsEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:24.125  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006442

14:42:24.125  TRACE  Total Execution Time (Completed) (async): 00:00:00.0021326. Rows Count: 1.

14:42:24.261  TRACE  Send message {ScanSettings, d0154a79-9069-0d43-b149-8318c1016788, Json, 4499 bytes}.
14:42:24.277  TRACE  Receive message {GetScanSettings, d0154a79-9069-0d43-b149-8318c1016788, Json, 108 bytes}.
14:42:24.357   INFO  Scan for project 5669769a-8cfe-4a96-811d-536887bdebde started
14:42:24.357  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
14:42:24.357  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003839

14:42:24.357  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ProjectEntity].[Id],
	[detail].[Id],
	[detail].[ProjectId],
	[detail].[Value]
FROM
	(
		SELECT DISTINCT
			[t1].[Id]
		FROM
			(
				SELECT
					[x].[Id]
				FROM
					[ProjectEntity] [x]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ProjectEntity]
		INNER JOIN [FilePatternEntity] [detail] ON [lw_ProjectEntity].[Id] = [detail].[Id]

14:42:24.357  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004243

14:42:24.357  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007893. Rows Count: 0.

14:42:24.357  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[Name],
	[x].[LastScanDate],
	[x].[CreationDate],
	[x].[SettingsId]
FROM
	[ProjectEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:24.357  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002053

14:42:24.357  TRACE  Total Execution Time (Completed) (async): 00:00:00.0014648. Rows Count: 1.

14:42:24.357  TRACE  BeforeExecute
DisposeTransactionAsync
14:42:24.357  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001907

14:42:24.369  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
14:42:24.369  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004432

14:42:24.369  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @projectName NVarChar(5) -- String
SET     @projectName = 'Smoke'

SELECT
	CASE
		WHEN EXISTS(
			SELECT
				*
			FROM
				[ProjectEntity] [x]
			WHERE
				[x].[Id] <> @id AND [x].[Name] = @projectName
		)
			THEN 1
		ELSE 0
	END

14:42:24.369  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004706

14:42:24.369  TRACE  Total Execution Time (Completed) (async): 00:00:00.0038712. Rows Count: 1.

14:42:24.384  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Name NVarChar(5) -- String
SET     @Name = 'Smoke'
DECLARE @LastScanDate  -- DateTime
SET     @LastScanDate = '2024-11-20 08:42:24.367'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'9F9E4BA2F658244E9AEF21946A863ADF'
DECLARE @Id  -- Guid
SET     @Id = X'9A766956FE8C964A811D536887BDEBDE'

UPDATE
	[ProjectEntity]
SET
	[Name] = @Name,
	[LastScanDate] = @LastScanDate,
	[SettingsId] = @SettingsId
WHERE
	[ProjectEntity].[Id] = @Id

14:42:24.384  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0110587. Records Affected: 1.

14:42:24.384  TRACE  Total Execution Time (Completed) (async): 00:00:00.0114636. Rows Count: 0.

14:42:24.384  TRACE  BeforeExecute
CommitTransactionAsync
14:42:24.402  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0065694

14:42:24.402  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
14:42:24.402  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002860

14:42:24.402  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:24.402  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002967

14:42:24.402  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005086. Rows Count: 0.

14:42:24.402  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:24.402  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002352

14:42:24.402  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004158. Rows Count: 0.

14:42:24.402  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:24.402  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003222

14:42:24.402  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005084. Rows Count: 0.

14:42:24.402  TRACE  BeforeExecute
DisposeTransactionAsync
14:42:24.402  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001642

14:42:24.402  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'E88D42B9E97F7441919C160282304B64'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[Data]
FROM
	[SettingsEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:24.402  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002410

14:42:24.402  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004368. Rows Count: 0.

14:42:24.424  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Data Binary(3526)
SET     @Data = X'8EA26964D92462393432386465382D376665392D343137342D393139632D313630323832333034623634A46E616D65A5536D6F6B65AE636F6D6D6F6E53657474696E6773DE001CAB746872656164436F756E7400A573636F7065C0B470726F6772616D6D'
-- value above truncated for logging
DECLARE @Id  -- Guid
SET     @Id = X'E88D42B9E97F7441919C160282304B64'

UPDATE
	[SettingsEntity]
SET
	[Data] = @Data
WHERE
	[SettingsEntity].[Id] = @Id

14:42:24.424  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004567. Records Affected: 0.

14:42:24.424  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Data Binary(3526)
SET     @Data = X'8EA26964D92462393432386465382D376665392D343137342D393139632D313630323832333034623634A46E616D65A5536D6F6B65AE636F6D6D6F6E53657474696E6773DE001CAB746872656164436F756E7400A573636F7065C0B470726F6772616D6D'
-- value above truncated for logging

INSERT INTO [SettingsEntity]
(
	[Id],
	[Data]
)
VALUES
(
	@Id,
	@Data
)

14:42:24.433  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0073451. Records Affected: 1.

14:42:24.433  TRACE  Total Execution Time (Completed) (async): 00:00:00.0091269. Rows Count: 0.

14:42:24.433  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @Stage  -- Int32
SET     @Stage = 0
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0

INSERT INTO [ScanResultProgressEntity]
(
	[ScanResultId],
	[Stage],
	[SubStage],
	[Value]
)
VALUES
(
	@ScanResultId,
	@Stage,
	@SubStage,
	@Value
)

14:42:24.451  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0074413. Records Affected: 1.

14:42:24.451  TRACE  Total Execution Time (Completed) (async): 00:00:00.0077602. Rows Count: 0.

14:42:24.451  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(8) -- String
SET     @ScanDurationRaw = '00:00:00'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 0
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0

INSERT INTO [ScanResultStatisticEntity]
(
	[ScanResultId],
	[State],
	[PolicyState],
	[ScanDurationRaw],
	[HighLevelVulnerabilityCount],
	[MediumLevelVulnerabilityCount],
	[LowLevelVulnerabilityCount],
	[PotentialVulnerabilityCount],
	[TotalBlackBoxVulnerabilityCount],
	[TotalStaticVulnerabilityCount],
	[TotalVulnerabilityCount],
	[TotalFileCount],
	[TotalUrlCount],
	[ScannedUrlCount],
	[ScannedFileCount]
)
VALUES
(
	@ScanResultId,
	@State,
	@PolicyState,
	@ScanDurationRaw,
	@HighLevelVulnerabilityCount,
	@MediumLevelVulnerabilityCount,
	@LowLevelVulnerabilityCount,
	@PotentialVulnerabilityCount,
	@TotalBlackBoxVulnerabilityCount,
	@TotalStaticVulnerabilityCount,
	@TotalVulnerabilityCount,
	@TotalFileCount,
	@TotalUrlCount,
	@ScannedUrlCount,
	@ScannedFileCount
)

14:42:24.465  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0075814. Records Affected: 1.

14:42:24.465  TRACE  Total Execution Time (Completed) (async): 00:00:00.0079339. Rows Count: 0.

14:42:24.465  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = NULL
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0

INSERT INTO [ScanEnvironmentEntity]
(
	[ScanResultId],
	[InfrastructureVersionId],
	[InstallatorVersionId],
	[ClientVersionId],
	[PmHash],
	[FullRescanOnNewFilesAdded]
)
VALUES
(
	@ScanResultId,
	@InfrastructureVersionId,
	@InstallatorVersionId,
	@ClientVersionId,
	@PmHash,
	@FullRescanOnNewFilesAdded
)

14:42:24.465  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0071577. Records Affected: 1.

14:42:24.465  TRACE  Total Execution Time (Completed) (async): 00:00:00.0075782. Rows Count: 0.

14:42:24.479  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B1D7DA2735E8254DA9ECB052A5F7AD20'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:24.479  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0075145. Records Affected: 1.

14:42:24.479  TRACE  Total Execution Time (Completed) (async): 00:00:00.0078242. Rows Count: 0.

14:42:24.479  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'5ABCDEF7C76A3F4CAF2F0943C3BD7403'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:24.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0070596. Records Affected: 1.

14:42:24.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0073243. Rows Count: 0.

14:42:24.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'73A36DB16511304A8D868C31E1C003FE'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:24.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0073720. Records Affected: 1.

14:42:24.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0076327. Rows Count: 0.

14:42:24.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'CE606C82E17064478253463475C53173'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:24.510  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0070521. Records Affected: 1.

14:42:24.510  TRACE  Total Execution Time (Completed) (async): 00:00:00.0074520. Rows Count: 0.

14:42:24.510  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'260F8D8FC6EC6F4B946CB73136B347D0'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:24.510  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0071649. Records Affected: 1.

14:42:24.510  TRACE  Total Execution Time (Completed) (async): 00:00:00.0075358. Rows Count: 0.

14:42:24.510  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-20 08:42:24.292'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0

INSERT INTO [ScanResultEntity]
(
	[Id],
	[ScanChainId],
	[ProjectId],
	[SettingsId],
	[Version],
	[ScanDate],
	[PreviousScanResultId],
	[IsRunFromQueue]
)
VALUES
(
	@Id,
	@ScanChainId,
	@ProjectId,
	@SettingsId,
	@Version,
	@ScanDate,
	@PreviousScanResultId,
	@IsRunFromQueue
)

14:42:24.530  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0073741. Records Affected: 1.

14:42:24.530  TRACE  Total Execution Time (Completed) (async): 00:00:00.0076726. Rows Count: 0.

14:42:24.530  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[ScanDate]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:24.530  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004339

14:42:24.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0019764. Rows Count: 1.

14:42:24.540  TRACE  BeforeExecute
BeginTransactionAsync(Serializable)
14:42:24.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003399

14:42:24.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ProjectEntity].[Id],
	[detail].[Id],
	[detail].[ProjectId],
	[detail].[Value]
FROM
	(
		SELECT DISTINCT
			[t1].[Id]
		FROM
			(
				SELECT
					[x].[Id]
				FROM
					[ProjectEntity] [x]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ProjectEntity]
		INNER JOIN [FilePatternEntity] [detail] ON [lw_ProjectEntity].[Id] = [detail].[Id]

14:42:24.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003703

14:42:24.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006036. Rows Count: 0.

14:42:24.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[Name],
	[x].[LastScanDate],
	[x].[CreationDate],
	[x].[SettingsId]
FROM
	[ProjectEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:24.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001974

14:42:24.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004182. Rows Count: 1.

14:42:24.540  TRACE  BeforeExecute
DisposeTransactionAsync
14:42:24.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001624

14:42:24.576  DEBUG  creating a work configuration for scan app type PmTaint
14:42:24.576  DEBUG  Created work configuration: CorePath: C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils\pm\AI.Taint.Cli.exe, WorkDirectory: C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils\pm, IsScanTargetAsFolder: True, RootScanDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke, LogDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Logs\Infrastructure\2024-11-20-14-38-47\PmTaint, LogLevel: Trace, IsExtensivelyLog: True, RootTempDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Temp, TempDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Temp\5669769a8cfe4a96811d536887bdebde\PmTaint, ScopeTempDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Temp\5669769a8cfe4a96811d536887bdebde, UtilsDirectory: C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils, ProxyFileName: , IsProxyUsed: False, CanScan: True, CustomParameters: , CustomRulesFile: , CpuRateLimit: 40, ApplicationDataDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai, AdditionalEnvironmentVariable: 
14:42:24.576  DEBUG  creating a work configuration for scan app type Configuration
14:42:24.576  DEBUG  Created work configuration: CorePath: C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils\config\AI.Config.exe, WorkDirectory: C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils\config, IsScanTargetAsFolder: True, RootScanDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke, LogDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Logs\Infrastructure\2024-11-20-14-38-47\Configuration, LogLevel: Trace, IsExtensivelyLog: True, RootTempDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Temp, TempDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Temp\5669769a8cfe4a96811d536887bdebde\Configuration, ScopeTempDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Temp\5669769a8cfe4a96811d536887bdebde, UtilsDirectory: C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils, ProxyFileName: , IsProxyUsed: False, CanScan: True, CustomParameters: , CustomRulesFile: , CpuRateLimit: 40, ApplicationDataDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai, AdditionalEnvironmentVariable: 
14:42:24.576  DEBUG  creating a work configuration for scan app type DependencyCheck
14:42:24.576  DEBUG  Created work configuration: CorePath: C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils\jdk1.11\bin\java.exe, WorkDirectory: C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils\dependencyCheck, IsScanTargetAsFolder: True, RootScanDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke, LogDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Logs\Infrastructure\2024-11-20-14-38-47\DependencyCheck, LogLevel: Trace, IsExtensivelyLog: True, RootTempDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Temp, TempDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Temp\5669769a8cfe4a96811d536887bdebde\DependencyCheck, ScopeTempDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Temp\5669769a8cfe4a96811d536887bdebde, UtilsDirectory: C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils, ProxyFileName: , IsProxyUsed: False, CanScan: True, CustomParameters: , CustomRulesFile: , CpuRateLimit: 40, ApplicationDataDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai, AdditionalEnvironmentVariable: 
14:42:24.576  DEBUG  creating a work configuration for scan app type PHP
14:42:24.576  DEBUG  Created work configuration: CorePath: C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils\php\AI.Php.exe, WorkDirectory: C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils\php, IsScanTargetAsFolder: True, RootScanDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke, LogDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Logs\Infrastructure\2024-11-20-14-38-47\PHP, LogLevel: Trace, IsExtensivelyLog: True, RootTempDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Temp, TempDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Temp\5669769a8cfe4a96811d536887bdebde\PHP, ScopeTempDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai\Temp\5669769a8cfe4a96811d536887bdebde, UtilsDirectory: C:\Users\sizyn\AppData\Local\Application Inspector Analyzer\utils, ProxyFileName: , IsProxyUsed: False, CanScan: True, CustomParameters: , CustomRulesFile: , CpuRateLimit: 40, ApplicationDataDirectory: C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.ai, AdditionalEnvironmentVariable: 
14:42:24.576  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:24.576  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002963

14:42:24.611  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @projectId  -- Guid
SET     @projectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_RelatedFilesKeyEntity].[Id_1],
	[lw_RelatedFilesKeyEntity].[Id],
	[detail_1].[Id],
	[detail_1].[RelatedFilesKeyId],
	[detail_1].[Value]
FROM
	(
		SELECT DISTINCT
			[detail].[Id],
			[lw_ScanRelatedFilesEntity].[Id] as [Id_1]
		FROM
			(
				SELECT DISTINCT
					[t1].[Id]
				FROM
					(
						SELECT
							[x].[Id]
						FROM
							[ScanRelatedFilesEntity] [x]
						WHERE
							[x].[ProjectId] = @projectId
						LIMIT @take
					) [t1]
			) [lw_ScanRelatedFilesEntity]
				INNER JOIN [RelatedFilesKeyEntity] [detail] ON [lw_ScanRelatedFilesEntity].[Id] = [detail].[ScanRelatedFilesId]
	) [lw_RelatedFilesKeyEntity]
		INNER JOIN [RelatedFilesValueEntity] [detail_1] ON [lw_RelatedFilesKeyEntity].[Id] = [detail_1].[RelatedFilesKeyId]

14:42:24.611  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007540

14:42:24.611  TRACE  Total Execution Time (Completed) (async): 00:00:00.0027557. Rows Count: 5.

14:42:24.611  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @projectId  -- Guid
SET     @projectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanRelatedFilesEntity].[Id],
	[detail].[Id],
	[detail].[ScanRelatedFilesId],
	[detail].[Key]
FROM
	(
		SELECT DISTINCT
			[t1].[Id]
		FROM
			(
				SELECT
					[x].[Id]
				FROM
					[ScanRelatedFilesEntity] [x]
				WHERE
					[x].[ProjectId] = @projectId
				LIMIT @take
			) [t1]
	) [lw_ScanRelatedFilesEntity]
		INNER JOIN [RelatedFilesKeyEntity] [detail] ON [lw_ScanRelatedFilesEntity].[Id] = [detail].[ScanRelatedFilesId]

14:42:24.611  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002451

14:42:24.611  TRACE  Total Execution Time (Completed) (async): 00:00:00.0016902. Rows Count: 5.

14:42:24.611  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @projectId  -- Guid
SET     @projectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ProjectId]
FROM
	[ScanRelatedFilesEntity] [x]
WHERE
	[x].[ProjectId] = @projectId
LIMIT @take

14:42:24.611  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002067

14:42:24.611  TRACE  Total Execution Time (Completed) (async): 00:00:00.0011881. Rows Count: 1.

14:42:24.622  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1FBC40754220EA4A97AA175F24956F9D'

DELETE FROM
	[RelatedFilesValueEntity]
WHERE
	[RelatedFilesValueEntity].[Id] = @Id

14:42:24.622  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0015554. Records Affected: 1.

14:42:24.622  TRACE  Total Execution Time (Completed) (async): 00:00:00.0020443. Rows Count: 0.

14:42:24.622  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'234721E60D5B1B41A4F6B3AFFD218E6A'

DELETE FROM
	[RelatedFilesKeyEntity]
WHERE
	[RelatedFilesKeyEntity].[Id] = @Id

14:42:24.622  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004285. Records Affected: 1.

14:42:24.622  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006613. Rows Count: 0.

14:42:24.622  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'EDF9E36E97D38144BD7BFF384D8E8E8E'

DELETE FROM
	[RelatedFilesValueEntity]
WHERE
	[RelatedFilesValueEntity].[Id] = @Id

14:42:24.622  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001986. Records Affected: 1.

14:42:24.622  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003862. Rows Count: 0.

14:42:24.622  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'483C0D4CBFD25D4B8A88319C406D9BE0'

DELETE FROM
	[RelatedFilesKeyEntity]
WHERE
	[RelatedFilesKeyEntity].[Id] = @Id

14:42:24.622  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001984. Records Affected: 1.

14:42:24.622  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003643. Rows Count: 0.

14:42:24.622  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'DCF2FE27CDAE4B4DBD325822B560ED32'

DELETE FROM
	[RelatedFilesValueEntity]
WHERE
	[RelatedFilesValueEntity].[Id] = @Id

14:42:24.622  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001691. Records Affected: 1.

14:42:24.622  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003185. Rows Count: 0.

14:42:24.622  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'8AAE410C7A564D4F8CAA64BEBCF98AEF'

DELETE FROM
	[RelatedFilesKeyEntity]
WHERE
	[RelatedFilesKeyEntity].[Id] = @Id

14:42:24.622  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001993. Records Affected: 1.

14:42:24.622  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003524. Rows Count: 0.

14:42:24.622  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'696404EB97EE3646BD35E9BCACE7958C'

DELETE FROM
	[RelatedFilesValueEntity]
WHERE
	[RelatedFilesValueEntity].[Id] = @Id

14:42:24.622  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001811. Records Affected: 1.

14:42:24.622  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003275. Rows Count: 0.

14:42:24.622  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1445C8B910B0284495E4732E73662271'

DELETE FROM
	[RelatedFilesKeyEntity]
WHERE
	[RelatedFilesKeyEntity].[Id] = @Id

14:42:24.622  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001767. Records Affected: 1.

14:42:24.622  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003266. Rows Count: 0.

14:42:24.622  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C2967A22FF5D234D8645E66F3B844F26'

DELETE FROM
	[RelatedFilesValueEntity]
WHERE
	[RelatedFilesValueEntity].[Id] = @Id

14:42:24.622  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001831. Records Affected: 1.

14:42:24.622  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003315. Rows Count: 0.

14:42:24.622  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'8C5D9FEFA5A6A145B011F9E5644AD05C'

DELETE FROM
	[RelatedFilesKeyEntity]
WHERE
	[RelatedFilesKeyEntity].[Id] = @Id

14:42:24.622  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001757. Records Affected: 1.

14:42:24.622  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003253. Rows Count: 0.

14:42:24.622  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'366FAFA083C6E24592375EBE7918EEEF'

DELETE FROM
	[ScanRelatedFilesEntity]
WHERE
	[ScanRelatedFilesEntity].[Id] = @Id

14:42:24.622  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004343. Records Affected: 1.

14:42:24.622  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006506. Rows Count: 0.

14:42:24.622  TRACE  BeforeExecute
CommitTransactionAsync
14:42:24.637  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0067023

14:42:24.637  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:24.637  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003655

14:42:24.637  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Data Binary(3648)
SET     @Data = X'8EA26964D92462393432386465382D376665392D343137342D393139632D313630323832333034623634A46E616D65A5536D6F6B65AE636F6D6D6F6E53657474696E6773DE001CAB746872656164436F756E7400A573636F7065D9203536363937363961'
-- value above truncated for logging
DECLARE @Id  -- Guid
SET     @Id = X'E88D42B9E97F7441919C160282304B64'

UPDATE
	[SettingsEntity]
SET
	[Data] = @Data
WHERE
	[SettingsEntity].[Id] = @Id

14:42:24.637  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007669. Records Affected: 1.

14:42:24.637  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010430. Rows Count: 0.

14:42:24.659  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:24.659  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005014

14:42:24.659  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008249. Rows Count: 0.

14:42:24.659  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:24.659  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002363

14:42:24.659  TRACE  Total Execution Time (Completed) (async): 00:00:00.0012127. Rows Count: 5.

14:42:24.659  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:24.659  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004341

14:42:24.666  TRACE  Total Execution Time (Completed) (async): 00:00:00.0040165. Rows Count: 1.

14:42:24.666  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 2
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

14:42:24.666  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003711. Records Affected: 1.

14:42:24.666  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005988. Rows Count: 0.

14:42:24.666  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(8) -- String
SET     @ScanDurationRaw = '00:00:00'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 0
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

14:42:24.666  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003216. Records Affected: 1.

14:42:24.666  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005711. Rows Count: 0.

14:42:24.666  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-20 08:42:24.292'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

14:42:24.666  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004975. Records Affected: 1.

14:42:24.666  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007609. Rows Count: 0.

14:42:24.666  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'AD62D0E55766A04E85D4E05643A774D4'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:24.666  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003440. Records Affected: 1.

14:42:24.666  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005451. Rows Count: 0.

14:42:24.666  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'A94FF65ACD119F47BA6BCC673D59E95D'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:24.666  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001890. Records Affected: 1.

14:42:24.666  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003385. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'A94FF65ACD119F47BA6BCC673D59E95D'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003469. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005389. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'327885D9BA94C248A7A2EDCEC67B28D2'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001928. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003554. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'327885D9BA94C248A7A2EDCEC67B28D2'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001822. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003289. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B1D7DA2735E8254DA9ECB052A5F7AD20'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003067. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005160. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'5ABCDEF7C76A3F4CAF2F0943C3BD7403'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001641. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003392. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'73A36DB16511304A8D868C31E1C003FE'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001607. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003159. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'CE606C82E17064478253463475C53173'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001764. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003116. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'260F8D8FC6EC6F4B946CB73136B347D0'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001495. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002907. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'924153D57AB78F44953A0386292E3306'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001915. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003419. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'A3969ACC46A06C47A988BF1792AC2EB8'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001661. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003057. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'E81ED32F04CD1047916A06234A0E6E89'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001644. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003053. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'A101C19F3F3CA24CBEB1EEF7907F0963'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001888. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003328. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'3E9E985B83988F47BC78D1F4A1A715BA'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001609. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002983. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'AD62D0E55766A04E85D4E05643A774D4'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

14:42:24.681  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002856. Records Affected: 1.

14:42:24.681  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005020. Rows Count: 0.

14:42:24.681  TRACE  BeforeExecute
CommitTransactionAsync
14:42:24.699  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0078049

14:42:24.699  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[ScanDate]
FROM
	[ScanResultEntity] [x]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:24.699  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002990

14:42:24.699  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005321. Rows Count: 1.

14:42:24.699  DEBUG  Send GET request https://aie-ub2210-41377.aie.ptsecurity.ru/api/configs/globalScanSettings with Id e50b5d94-6e1c-4e8c-83d8-37a4da71e789
14:42:24.699  TRACE  Receive message {StartScan, 770a6305-b072-4747-8677-2456f2bfaaba, Json, 5720 bytes}.
14:42:25.129  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Data Binary(3648)
SET     @Data = X'8EA26964D92462393432386465382D376665392D343137342D393139632D313630323832333034623634A46E616D65A5536D6F6B65AE636F6D6D6F6E53657474696E6773DE001CAB746872656164436F756E7400A573636F7065D9203536363937363961'
-- value above truncated for logging
DECLARE @Id  -- Guid
SET     @Id = X'E88D42B9E97F7441919C160282304B64'

UPDATE
	[SettingsEntity]
SET
	[Data] = @Data
WHERE
	[SettingsEntity].[Id] = @Id

14:42:25.129  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005496. Records Affected: 1.

14:42:25.129  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008359. Rows Count: 0.

14:42:25.136  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003644

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003837

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0015956. Rows Count: 2.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003009

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005299. Rows Count: 5.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003252

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005600. Rows Count: 1.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 1
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006254. Records Affected: 1.

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008081. Rows Count: 0.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(8) -- String
SET     @ScanDurationRaw = '00:00:00'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 0
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002444. Records Affected: 1.

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004151. Rows Count: 0.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-20 08:42:24.292'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005010. Records Affected: 1.

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006752. Rows Count: 0.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'AD62D0E55766A04E85D4E05643A774D4'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004841. Records Affected: 1.

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007489. Rows Count: 0.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'3DE62A47F72A8A459885A62F8F0A7EE2'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003016. Records Affected: 1.

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005496. Rows Count: 0.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'A94FF65ACD119F47BA6BCC673D59E95D'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004280. Records Affected: 1.

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006316. Rows Count: 0.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'A94FF65ACD119F47BA6BCC673D59E95D'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002069. Records Affected: 1.

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003492. Rows Count: 0.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'327885D9BA94C248A7A2EDCEC67B28D2'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001559. Records Affected: 1.

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002948. Rows Count: 0.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'327885D9BA94C248A7A2EDCEC67B28D2'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001947. Records Affected: 1.

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003343. Rows Count: 0.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'8F65A3535132F24DA9E77864F80CB61F'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001723. Records Affected: 1.

14:42:25.136  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003444. Rows Count: 0.

14:42:25.136  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'8F65A3535132F24DA9E77864F80CB61F'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:25.136  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001635. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003030. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'2139EC42F5C1F44596F3FA49BFEAFE8C'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001648. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003031. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'2139EC42F5C1F44596F3FA49BFEAFE8C'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001592. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002951. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'924153D57AB78F44953A0386292E3306'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002427. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003820. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'A3969ACC46A06C47A988BF1792AC2EB8'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001459. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002790. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'E81ED32F04CD1047916A06234A0E6E89'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001445. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002744. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'A101C19F3F3CA24CBEB1EEF7907F0963'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001580. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002940. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'3E9E985B83988F47BC78D1F4A1A715BA'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001438. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003036. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'AB14FDCA7C11BE439C7B7A135FDABAA0'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001881. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003315. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4440E3A5DE6B87429D039206C56AEBDE'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001572. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002901. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'660A0464B5754141837CB1B07ED7E20D'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001543. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002864. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'5760D287BAD42F4693C300BBCDFEB16A'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001567. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002907. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'28F23EC956AB4D4492F4AD9235DE5029'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001549. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002879. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'3DE62A47F72A8A459885A62F8F0A7EE2'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002291. Records Affected: 1.

14:42:25.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003794. Rows Count: 0.

14:42:25.149  TRACE  BeforeExecute
CommitTransactionAsync
14:42:25.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0073142

14:42:25.210  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:25.210  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005843

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003262

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005401. Rows Count: 2.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002045

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003835. Rows Count: 5.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005008

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008351. Rows Count: 1.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 1
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003448. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005078. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(8) -- String
SET     @ScanDurationRaw = '00:00:00'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006721. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008928. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-20 08:42:24.292'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004898. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006496. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'3DE62A47F72A8A459885A62F8F0A7EE2'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003421. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004892. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'BE0D8AB07F23E04AB7C3200508F77AAA'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001731. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003171. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'8F65A3535132F24DA9E77864F80CB61F'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002364. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003763. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'8F65A3535132F24DA9E77864F80CB61F'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001990. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003431. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'2139EC42F5C1F44596F3FA49BFEAFE8C'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001838. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003242. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'2139EC42F5C1F44596F3FA49BFEAFE8C'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001931. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003345. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'3841AEF27717E34981744A12C88C83F7'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001652. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003061. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'3841AEF27717E34981744A12C88C83F7'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001597. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002981. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'7AFFEB0DB39B864E8243B9D98FD37E98'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001613. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002978. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'7AFFEB0DB39B864E8243B9D98FD37E98'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001577. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002932. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'AB14FDCA7C11BE439C7B7A135FDABAA0'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002375. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003764. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4440E3A5DE6B87429D039206C56AEBDE'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001460. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003010. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'660A0464B5754141837CB1B07ED7E20D'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001447. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002757. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'5760D287BAD42F4693C300BBCDFEB16A'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001458. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002759. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'28F23EC956AB4D4492F4AD9235DE5029'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001440. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002740. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C0ABD4181108F8479EABE166D31747C7'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001713. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003149. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'D46B9841A593F94BACF5B1012D73717E'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001558. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002893. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C3668068A166DF42A603E28E4E3255E8'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001558. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002884. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C80631D574C2324D842F997A45F7406D'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001785. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003152. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'8619F86D9D08804C8F1769475D4162E2'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001565. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002914. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'BE0D8AB07F23E04AB7C3200508F77AAA'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

14:42:25.212  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002197. Records Affected: 1.

14:42:25.212  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004478. Rows Count: 0.

14:42:25.212  TRACE  BeforeExecute
CommitTransactionAsync
14:42:25.234  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0073635

14:42:25.462  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003539

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004395

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007872. Rows Count: 2.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003834

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006730. Rows Count: 5.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004855

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008415. Rows Count: 1.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 1
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 100
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0013997. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0016336. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(8) -- String
SET     @ScanDurationRaw = '00:00:00'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003010. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004893. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-20 08:42:24.292'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004738. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006381. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'BE0D8AB07F23E04AB7C3200508F77AAA'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003802. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005376. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4D8D1A6FEBDCD248954BB8C69D4DE4D1'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001861. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003648. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'3841AEF27717E34981744A12C88C83F7'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002521. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003972. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'3841AEF27717E34981744A12C88C83F7'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002328. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003862. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'7AFFEB0DB39B864E8243B9D98FD37E98'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001668. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003567. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'7AFFEB0DB39B864E8243B9D98FD37E98'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002299. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003808. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1BC0A3F8D41BCC489E4BA0BC7D3DB5E7'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001860. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003381. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'1BC0A3F8D41BCC489E4BA0BC7D3DB5E7'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001726. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003138. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'70411CBA700AB5478C82811F078829A4'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001857. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003585. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'70411CBA700AB5478C82811F078829A4'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002118. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003602. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C0ABD4181108F8479EABE166D31747C7'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002683. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004204. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'D46B9841A593F94BACF5B1012D73717E'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002087. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003497. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C3668068A166DF42A603E28E4E3255E8'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001599. Records Affected: 1.

14:42:25.462  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003071. Rows Count: 0.

14:42:25.462  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C80631D574C2324D842F997A45F7406D'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.462  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001575. Records Affected: 1.

14:42:25.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003318. Rows Count: 0.

14:42:25.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'8619F86D9D08804C8F1769475D4162E2'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002001. Records Affected: 1.

14:42:25.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003668. Rows Count: 0.

14:42:25.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B2994F7EB767714ABAFDDC139F94CF32'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002160. Records Affected: 1.

14:42:25.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003998. Rows Count: 0.

14:42:25.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1064DE0E892D7740AB3F0898B4922671'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001953. Records Affected: 1.

14:42:25.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003972. Rows Count: 0.

14:42:25.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'43CC8D419798AB408DDEDA6542D12194'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001842. Records Affected: 1.

14:42:25.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003347. Rows Count: 0.

14:42:25.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'71806AA96BAB4645B7830073DCE175AC'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002279. Records Affected: 1.

14:42:25.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003823. Rows Count: 0.

14:42:25.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B9AD0C47F426F94FB8853AC773C72F02'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001658. Records Affected: 1.

14:42:25.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003070. Rows Count: 0.

14:42:25.478  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'4D8D1A6FEBDCD248954BB8C69D4DE4D1'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

14:42:25.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002250. Records Affected: 1.

14:42:25.478  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003850. Rows Count: 0.

14:42:25.478  TRACE  BeforeExecute
CommitTransactionAsync
14:42:25.478  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0070515

14:42:25.495  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004823

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003565

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005825. Rows Count: 2.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002201

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004088. Rows Count: 5.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003173

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005217. Rows Count: 1.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 2
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006568. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009386. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(8) -- String
SET     @ScanDurationRaw = '00:00:00'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002880. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004802. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-20 08:42:24.292'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004914. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006562. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4D8D1A6FEBDCD248954BB8C69D4DE4D1'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003703. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005207. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'0FD0F5DA156D8E438BDBD22B01410F14'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001712. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003169. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'1BC0A3F8D41BCC489E4BA0BC7D3DB5E7'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002369. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003787. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1BC0A3F8D41BCC489E4BA0BC7D3DB5E7'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002053. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003794. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'70411CBA700AB5478C82811F078829A4'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001881. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004259. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'70411CBA700AB5478C82811F078829A4'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003242. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005544. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'546BFBD4D5FC8145B241A2FC6BE00E39'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001794. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003277. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'546BFBD4D5FC8145B241A2FC6BE00E39'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001690. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003125. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B12A1B6C8B529F4ABFF0648FF2E999F0'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001612. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002989. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'B12A1B6C8B529F4ABFF0648FF2E999F0'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001587. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002951. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B2994F7EB767714ABAFDDC139F94CF32'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002438. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003839. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1064DE0E892D7740AB3F0898B4922671'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001455. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002786. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'43CC8D419798AB408DDEDA6542D12194'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001441. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002767. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'71806AA96BAB4645B7830073DCE175AC'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001449. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002769. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B9AD0C47F426F94FB8853AC773C72F02'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001439. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002750. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'CFB14FA5839CD34BBA00EF82C6F67E05'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001772. Records Affected: 1.

14:42:25.495  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003224. Rows Count: 0.

14:42:25.495  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'04E3098E4EA20946B304175EA5E7DC70'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.495  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001564. Records Affected: 1.

14:42:25.508  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002921. Rows Count: 0.

14:42:25.508  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'94430C20EB74534E9D6DFFCC61F2A897'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.508  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002363. Records Affected: 1.

14:42:25.508  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004483. Rows Count: 0.

14:42:25.508  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B08BB2B0E9E08548808D3AEAB7B49BE8'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.508  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002134. Records Affected: 1.

14:42:25.508  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004200. Rows Count: 0.

14:42:25.508  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'BBDD5CBE2D74C54EB3BD7E74D53965B2'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:25.508  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002303. Records Affected: 1.

14:42:25.508  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004283. Rows Count: 0.

14:42:25.508  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'0FD0F5DA156D8E438BDBD22B01410F14'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

14:42:25.508  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003766. Records Affected: 1.

14:42:25.508  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006417. Rows Count: 0.

14:42:25.508  TRACE  BeforeExecute
CommitTransactionAsync
14:42:25.508  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0072466

14:42:25.803  DEBUG  Start checking connection to AIE with 'https://aie-ub2210-41377.aie.ptsecurity.ru/health/summary' uri
14:42:26.311  DEBUG  Connection status to AIE status has not been changed. Status is 'True'
14:42:26.465  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:26.465  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003928

14:42:26.465  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:26.465  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003620

14:42:26.465  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005700. Rows Count: 2.

14:42:26.465  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:26.465  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002223

14:42:26.465  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004125. Rows Count: 5.

14:42:26.465  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:26.465  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003135

14:42:26.465  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006458. Rows Count: 1.

14:42:26.465  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 2
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

14:42:26.465  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001878. Records Affected: 1.

14:42:26.465  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003398. Rows Count: 0.

14:42:26.465  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(8) -- String
SET     @ScanDurationRaw = '00:00:00'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

14:42:26.465  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002372. Records Affected: 1.

14:42:26.465  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003977. Rows Count: 0.

14:42:26.465  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-20 08:42:24.292'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0097835. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0100675. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'0FD0F5DA156D8E438BDBD22B01410F14'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004350. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006158. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'F3F777041947C44CAA6FF394CE0FC1E3'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001806. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003296. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'546BFBD4D5FC8145B241A2FC6BE00E39'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002538. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003907. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'546BFBD4D5FC8145B241A2FC6BE00E39'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002013. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003407. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'B12A1B6C8B529F4ABFF0648FF2E999F0'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001775. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003129. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B12A1B6C8B529F4ABFF0648FF2E999F0'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001821. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003519. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'F81CC5352471E94FAD73B86A8FF4F484'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001593. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002953. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'F81CC5352471E94FAD73B86A8FF4F484'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001515. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002825. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'A39FC4282A99284DB95F0C1FA58151E0'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001546. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002878. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'A39FC4282A99284DB95F0C1FA58151E0'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001491. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002801. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'CFB14FA5839CD34BBA00EF82C6F67E05'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002280. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003680. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'04E3098E4EA20946B304175EA5E7DC70'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001696. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003031. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'94430C20EB74534E9D6DFFCC61F2A897'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001408. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002691. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B08BB2B0E9E08548808D3AEAB7B49BE8'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001376. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002633. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'BBDD5CBE2D74C54EB3BD7E74D53965B2'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001354. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002653. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9BFB4E134CDA4142BE372CE5C2AE9FAA'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001665. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003098. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'131C04CA0CB64747BEDE38ACDE01F429'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001489. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002813. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'2C0DDE768AB0994389B14C5A0897AC74'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001457. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002720. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C576543D172B7A47AF1A86AEA79B6ED2'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001976. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003611. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'5FFE16C9F780C947A5DCE55083FCAA7A'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001460. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002724. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'F3F777041947C44CAA6FF394CE0FC1E3'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

14:42:26.480  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001836. Records Affected: 1.

14:42:26.480  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003255. Rows Count: 0.

14:42:26.480  TRACE  BeforeExecute
CommitTransactionAsync
14:42:26.497  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0071566

14:42:26.745  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:26.745  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004111

14:42:26.745  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:26.745  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003317

14:42:26.745  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005947. Rows Count: 2.

14:42:26.745  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:26.745  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003403

14:42:26.745  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006189. Rows Count: 5.

14:42:26.745  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:26.745  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004155

14:42:26.745  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007047. Rows Count: 1.

14:42:26.745  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 2
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 100
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

14:42:26.745  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0014268. Records Affected: 1.

14:42:26.745  TRACE  Total Execution Time (Completed) (async): 00:00:00.0017471. Rows Count: 0.

14:42:26.745  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(8) -- String
SET     @ScanDurationRaw = '00:00:00'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

14:42:26.745  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004144. Records Affected: 1.

14:42:26.745  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006511. Rows Count: 0.

14:42:26.745  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-20 08:42:24.292'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006311. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0008360. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'F3F777041947C44CAA6FF394CE0FC1E3'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005102. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007139. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'48C3396D08E8644E984CF1A120E1E40B'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002601. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004544. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'F81CC5352471E94FAD73B86A8FF4F484'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003348. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005201. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'F81CC5352471E94FAD73B86A8FF4F484'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002859. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004746. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'A39FC4282A99284DB95F0C1FA58151E0'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002126. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003897. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'A39FC4282A99284DB95F0C1FA58151E0'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002662. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004506. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1153C6F981551A469F70DA68B1B8FEB3'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002780. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004997. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'1153C6F981551A469F70DA68B1B8FEB3'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002390. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004359. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'410BE4C5248D484684000523CDB6DEF9'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002365. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004302. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'410BE4C5248D484684000523CDB6DEF9'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002347. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004268. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9BFB4E134CDA4142BE372CE5C2AE9FAA'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003536. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005630. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'131C04CA0CB64747BEDE38ACDE01F429'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002110. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003559. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'2C0DDE768AB0994389B14C5A0897AC74'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001702. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003593. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C576543D172B7A47AF1A86AEA79B6ED2'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001652. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003137. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'5FFE16C9F780C947A5DCE55083FCAA7A'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001666. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003530. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'F3D3A161F10E4940B98CB44ABFA4473D'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002030. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003786. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9F94D84A0E4C84499A57F8D513020764'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002092. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003632. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'E7330566295B6547823EE61BD3DB18F8'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001639. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003073. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9B027843E88D58429CC774A887960AB4'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001821. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003236. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'D8CF4BE2B6C4F545BA55CA0338AAB41F'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001823. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004097. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'48C3396D08E8644E984CF1A120E1E40B'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

14:42:26.759  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002580. Records Affected: 1.

14:42:26.759  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004577. Rows Count: 0.

14:42:26.759  TRACE  BeforeExecute
CommitTransactionAsync
14:42:26.780  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0073795

14:42:26.780  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:26.780  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006642

14:42:26.780  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:26.780  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003901

14:42:26.780  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006326. Rows Count: 2.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002469

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004573. Rows Count: 5.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003592

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005739. Rows Count: 1.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 3
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007283. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009273. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(8) -- String
SET     @ScanDurationRaw = '00:00:00'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002760. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004553. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-20 08:42:24.292'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006223. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009136. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'48C3396D08E8644E984CF1A120E1E40B'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005431. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007272. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'D85D7DB0ACA7B34FBE96DE09BE82FDF1'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002531. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004231. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'1153C6F981551A469F70DA68B1B8FEB3'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003786. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005559. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1153C6F981551A469F70DA68B1B8FEB3'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002382. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003991. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'410BE4C5248D484684000523CDB6DEF9'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001837. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003595. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'410BE4C5248D484684000523CDB6DEF9'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002179. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003806. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'89101733DCE0D542BF1A284989F5CC6E'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001883. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003450. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'89101733DCE0D542BF1A284989F5CC6E'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001965. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003565. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'91B787BE74C76249ABB2CB7FD1A75BC1'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001849. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003330. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'91B787BE74C76249ABB2CB7FD1A75BC1'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001709. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003139. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'F3D3A161F10E4940B98CB44ABFA4473D'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003054. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004584. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9F94D84A0E4C84499A57F8D513020764'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001513. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002942. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'E7330566295B6547823EE61BD3DB18F8'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001591. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002920. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9B027843E88D58429CC774A887960AB4'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001546. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002943. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'D8CF4BE2B6C4F545BA55CA0338AAB41F'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001435. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002814. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'7A3C2FCBF5998D42904AF07968A54CEC'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003049. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005202. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'CF563AD83FE68045852F0428A397A7B1'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002398. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004475. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'5B1E2051CF31D547983B098C0E7D160D'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002452. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004398. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B29EA24114301C4795D890614458A3C0'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002147. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003791. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'53F7306710BCCC45A422135E82B82B86'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:26.790  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001753. Records Affected: 1.

14:42:26.790  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003213. Rows Count: 0.

14:42:26.790  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'D85D7DB0ACA7B34FBE96DE09BE82FDF1'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

14:42:26.806  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002787. Records Affected: 1.

14:42:26.806  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004403. Rows Count: 0.

14:42:26.806  TRACE  BeforeExecute
CommitTransactionAsync
14:42:26.806  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0072544

14:42:28.142  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(16) -- String
SET     @ScanDurationRaw = '00:00:03.0091233'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

14:42:28.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0080169. Records Affected: 1.

14:42:28.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0083162. Rows Count: 0.

14:42:28.149  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 3
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 25
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

14:42:28.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0068654. Records Affected: 1.

14:42:28.149  TRACE  Total Execution Time (Completed) (async): 00:00:00.0070771. Rows Count: 0.

14:42:28.149  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:28.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003321

14:42:28.149  TRACE  BeforeExecute
CommitTransactionAsync
14:42:28.149  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002114

14:42:29.487  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:29.487  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002564

14:42:29.487  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:29.487  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004088

14:42:29.487  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007063. Rows Count: 2.

14:42:29.487  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:29.487  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003143

14:42:29.487  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005697. Rows Count: 5.

14:42:29.487  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:29.487  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004660

14:42:29.487  TRACE  Total Execution Time (Completed) (async): 00:00:00.0007071. Rows Count: 1.

14:42:29.487  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 3
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 100
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

14:42:29.487  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007422. Records Affected: 1.

14:42:29.487  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009098. Rows Count: 0.

14:42:29.487  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(16) -- String
SET     @ScanDurationRaw = '00:00:03.0091233'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

14:42:29.487  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002203. Records Affected: 1.

14:42:29.487  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003741. Rows Count: 0.

14:42:29.487  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-20 08:42:24.292'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

14:42:29.487  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004731. Records Affected: 1.

14:42:29.487  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006208. Rows Count: 0.

14:42:29.487  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'D85D7DB0ACA7B34FBE96DE09BE82FDF1'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:29.487  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003515. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004935. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9D579D194FA09A4BB59641BCDD193CBA'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001970. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003535. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'89101733DCE0D542BF1A284989F5CC6E'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002573. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004040. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'89101733DCE0D542BF1A284989F5CC6E'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001880. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003243. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'91B787BE74C76249ABB2CB7FD1A75BC1'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001455. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002780. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'91B787BE74C76249ABB2CB7FD1A75BC1'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001924. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003300. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'BDBC8E7B5864884C8C4C00F7F0FFF2E3'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001927. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003301. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'BDBC8E7B5864884C8C4C00F7F0FFF2E3'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001474. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002769. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9974B1E205605545810E63B26F5089B4'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001496. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002773. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'9974B1E205605545810E63B26F5089B4'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001451. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003677. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'7A3C2FCBF5998D42904AF07968A54CEC'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003284. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005142. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'CF563AD83FE68045852F0428A397A7B1'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002233. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004007. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'5B1E2051CF31D547983B098C0E7D160D'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002031. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004076. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'B29EA24114301C4795D890614458A3C0'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001994. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004368. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'53F7306710BCCC45A422135E82B82B86'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002055. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003769. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'74399B4D370C9949A16951075FE6D026'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002507. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004435. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'BBCA71774C1A424FAFDACD5147883A8E'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001927. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003649. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'159C5CD0A53FA64ABC6C4557FDF2946E'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001985. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003645. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9418AC455427514D87BCDB5D6952A8C6'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001519. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002796. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'91F16FFC776561438156934A9F50E55C'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001439. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003103. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'9D579D194FA09A4BB59641BCDD193CBA'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

14:42:29.494  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001956. Records Affected: 1.

14:42:29.494  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003351. Rows Count: 0.

14:42:29.494  TRACE  BeforeExecute
CommitTransactionAsync
14:42:29.511  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0071185

14:42:29.511  TRACE  BeforeExecute
BeginTransaction(Serializable)
14:42:29.511  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002921

14:42:29.511  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [x]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		WHERE
			[x].[ProjectId] = @id
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:29.511  TRACE  Query Execution Time (AfterExecute): 00:00:00.0002774

14:42:29.511  TRACE  Total Execution Time (Completed): 00:00:00.0006852. Rows Count: 56.

14:42:29.511  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[a_ScanEnvironment].[ScanResultId]
		FROM
			[ScanResultEntity] [x]
				LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		WHERE
			[x].[ProjectId] = @id
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:29.511  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003477

14:42:29.511  TRACE  Total Execution Time (Completed): 00:00:00.0006689. Rows Count: 140.

14:42:29.511  TRACE  BeforeExecute
DisposeTransaction
14:42:29.511  TRACE  Query Execution Time (AfterExecute): 00:00:00.0001640

14:42:29.511  TRACE  BeforeExecute
--  SQLite.MS SQLite
DECLARE @id  -- Guid
SET     @id = X'9A766956FE8C964A811D536887BDEBDE'

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[ProjectId] = @id

14:42:29.511  TRACE  Query Execution Time (AfterExecute): 00:00:00.0003712

14:42:29.511  TRACE  Total Execution Time (Completed): 00:00:00.0008550. Rows Count: 28.

14:42:29.525  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0006296

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002855

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004942. Rows Count: 2.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002499

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004394. Rows Count: 5.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003391

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005668. Rows Count: 1.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 3
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 100
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002218. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003688. Rows Count: 0.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(16) -- String
SET     @ScanDurationRaw = '00:00:03.0091233'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002662. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004289. Rows Count: 0.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-20 08:42:24.292'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0008144. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0009774. Rows Count: 0.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9D579D194FA09A4BB59641BCDD193CBA'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003542. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004997. Rows Count: 0.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'553AE2D9D0954F4897CB4452C854D793'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001797. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003637. Rows Count: 0.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'BDBC8E7B5864884C8C4C00F7F0FFF2E3'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003044. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004452. Rows Count: 0.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'BDBC8E7B5864884C8C4C00F7F0FFF2E3'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002180. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003590. Rows Count: 0.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'9974B1E205605545810E63B26F5089B4'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001724. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003037. Rows Count: 0.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9974B1E205605545810E63B26F5089B4'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002026. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003473. Rows Count: 0.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'0EF48F1A772D644FA0C1F3AD37FC0BF6'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001643. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003182. Rows Count: 0.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'0EF48F1A772D644FA0C1F3AD37FC0BF6'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001748. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003344. Rows Count: 0.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'19DD136CCCBBDF4BBD724725E90A62E8'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001782. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003783. Rows Count: 0.

14:42:29.525  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'19DD136CCCBBDF4BBD724725E90A62E8'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:29.525  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002430. Records Affected: 1.

14:42:29.525  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003915. Rows Count: 0.

14:42:29.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'74399B4D370C9949A16951075FE6D026'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002658. Records Affected: 1.

14:42:29.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004174. Rows Count: 0.

14:42:29.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'BBCA71774C1A424FAFDACD5147883A8E'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001501. Records Affected: 1.

14:42:29.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0030313. Rows Count: 0.

14:42:29.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'159C5CD0A53FA64ABC6C4557FDF2946E'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002081. Records Affected: 1.

14:42:29.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003558. Rows Count: 0.

14:42:29.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'9418AC455427514D87BCDB5D6952A8C6'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001454. Records Affected: 1.

14:42:29.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002726. Rows Count: 0.

14:42:29.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'91F16FFC776561438156934A9F50E55C'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001394. Records Affected: 1.

14:42:29.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002680. Rows Count: 0.

14:42:29.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4496E845B29C2242BAA3B2E2646972E8'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001814. Records Affected: 1.

14:42:29.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003228. Rows Count: 0.

14:42:29.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'DA59076600EE42449B8A1D67149FAFDD'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001476. Records Affected: 1.

14:42:29.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002724. Rows Count: 0.

14:42:29.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4FC4F4DA9308D041B75C620FFD4EF6FE'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002001. Records Affected: 1.

14:42:29.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003390. Rows Count: 0.

14:42:29.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'ADF612A743423645ADD47C579ABFFC3C'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001435. Records Affected: 1.

14:42:29.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002722. Rows Count: 0.

14:42:29.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'0742F2DC76AE6942A15760D6AD863962'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001449. Records Affected: 1.

14:42:29.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002697. Rows Count: 0.

14:42:29.540  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'553AE2D9D0954F4897CB4452C854D793'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

14:42:29.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001886. Records Affected: 1.

14:42:29.540  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003266. Rows Count: 0.

14:42:29.540  TRACE  BeforeExecute
CommitTransactionAsync
14:42:29.540  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0068185

14:42:29.578  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:29.578  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003752

14:42:29.578  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'CE06D4141D822547A3B4E87D9633B940'
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @RootNodePath NVarChar(1) -- String
SET     @RootNodePath = '.'

INSERT INTO [VfsEntity]
(
	[Id],
	[ScanResultId],
	[RootNodePath]
)
VALUES
(
	@Id,
	@ScanResultId,
	@RootNodePath
)

14:42:29.578  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0008372. Records Affected: 1.

14:42:29.578  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010441. Rows Count: 0.

14:42:29.578  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)

INSERT INTO [VfsNodeEntity]
(
	[VfsId],
	[NodePath],
	[PhysicalPath],
	[MaxIssueLevel],
	[ScanByCores],
	[ScanningByCores],
	[ScannedByCores],
	[NodeType],
	[IncludeInScan],
	[LifeTimeStatus],
	[LastModifiedDate],
	[Hash]
)
VALUES
(X'CE06D4141D822547A3B4E87D9633B940','./.idea','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.idea',0,0,0,0,2,0,4,1732091917,NULL),
(X'CE06D4141D822547A3B4E87D9633B940','./.idea/.gitignore','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.idea\.gitignore',0,610,0,0,1,0,4,1731649643,X'1B27BEEDEB67EA5B2249F73FE6F7985C387BEE94'),
(X'CE06D4141D822547A3B4E87D9633B940','./.idea/jsonSchemas.xml','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.idea\jsonSchemas.xml',0,610,0,0,1,0,4,1731649666,X'85189B596F184348468ABB4549BCC0FAA8FFA132'),
(X'CE06D4141D822547A3B4E87D9633B940','./.idea/misc.xml','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.idea\misc.xml',0,610,0,0,1,0,4,1731649642,X'4E4A99C11285D6F07790651B248485765382994D'),
(X'CE06D4141D822547A3B4E87D9633B940','./.idea/modules.xml','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.idea\modules.xml',0,610,0,0,1,0,4,1731649642,X'AA648717363985C7AEFAE827473E18340824D5B2'),
(X'CE06D4141D822547A3B4E87D9633B940','./.idea/Smoke.iml','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.idea\Smoke.iml',0,610,0,0,1,0,4,1731649642,X'402E38DEF734B476C4C697C9A36892567AB6AF8B'),
(X'CE06D4141D822547A3B4E87D9633B940','./.idea/workspace.xml','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\.idea\workspace.xml',0,610,0,0,1,0,4,1732091917,X'7E4EFD89CA83723BC23B96DE43621B9E14E2BF6B'),
(X'CE06D4141D822547A3B4E87D9633B940','./dir','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\dir',0,0,0,0,2,1,4,1731650154,NULL),
(X'CE06D4141D822547A3B4E87D9633B940','./dir/oscom.php','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\dir\oscom.php',0,610,0,0,1,1,4,1708615166,X'C99B874B1322B2C5ABB415377B3EED2778EBE416'),
(X'CE06D4141D822547A3B4E87D9633B940','./dir/sqli.php','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\dir\sqli.php',0,610,0,0,1,1,4,1731650154,X'5DCB64E7D97029997F922C9453322EDCFC8E012E'),
(X'CE06D4141D822547A3B4E87D9633B940','./dir/xss.php','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\dir\xss.php',0,610,0,0,1,1,4,1708615166,X'CF2F1291039BFD76C717D37C02968A21514B3480'),
(X'CE06D4141D822547A3B4E87D9633B940','./xss.abc','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\xss.abc',0,610,0,0,1,1,4,1708615166,X'CF2F1291039BFD76C717D37C02968A21514B3480'),
(X'CE06D4141D822547A3B4E87D9633B940','./xsspm.php','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke\xsspm.php',0,610,0,0,1,1,4,1708615166,X'F8BA37D318F43818D0B2E26F9AEE08362F35D458'),
(X'CE06D4141D822547A3B4E87D9633B940','.','C:\PositiveTechnologies\AI\apps\PHP\apps\Smoke',0,0,0,0,2,1,4,1731653349,NULL)

14:42:29.578  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0007906. Records Affected: 14.

14:42:29.578  TRACE  Total Execution Time (Completed) (async): 00:00:00.0010152. Rows Count: 14.

14:42:29.578  TRACE  BeforeExecute
CommitTransactionAsync
14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0066565

14:42:29.594  TRACE  BeforeExecute
BeginTransactionAsync(Unspecified)
14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002798

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[ComponentVersionId],
	[detail].[ScanEnvironmentId],
	[a_ComponentVersion].[Id],
	[a_ComponentVersion].[Type],
	[a_ComponentVersion].[Version]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [ScanEnvironmentComponentVersionsEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]
		LEFT JOIN [ComponentVersionEntity] [a_ComponentVersion] ON [detail].[ComponentVersionId] = [a_ComponentVersion].[Id]

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003064

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004953. Rows Count: 2.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 1

SELECT
	[lw_ScanEnvironmentEntity].[ScanResultId],
	[detail].[Id],
	[detail].[ScanEnvironmentId],
	[detail].[ScanAppType],
	[detail].[Hash]
FROM
	(
		SELECT DISTINCT
			[t1].[ScanResultId]
		FROM
			(
				SELECT
					[a_ScanEnvironment].[ScanResultId]
				FROM
					[ScanResultEntity] [x]
						LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
				WHERE
					[x].[Id] = @id
				LIMIT @take
			) [t1]
	) [lw_ScanEnvironmentEntity]
		INNER JOIN [SastHashesEntity] [detail] ON [lw_ScanEnvironmentEntity].[ScanResultId] = [detail].[ScanEnvironmentId]

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001923

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003570. Rows Count: 5.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @id  -- Guid
SET     @id = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @take  -- Int32
SET     @take = 2

SELECT
	[x].[Id],
	[x].[ScanChainId],
	[x].[ProjectId],
	[x].[SettingsId],
	[x].[Version],
	[x].[ScanDate],
	[x].[PreviousScanResultId],
	[x].[IsRunFromQueue],
	[a_Progress].[ScanResultId],
	[a_Progress].[Stage],
	[a_Progress].[SubStage],
	[a_Progress].[Value],
	[a_Statistic].[ScanResultId],
	[a_Statistic].[State],
	[a_Statistic].[PolicyState],
	[a_Statistic].[ScanDurationRaw],
	[a_Statistic].[HighLevelVulnerabilityCount],
	[a_Statistic].[MediumLevelVulnerabilityCount],
	[a_Statistic].[LowLevelVulnerabilityCount],
	[a_Statistic].[PotentialVulnerabilityCount],
	[a_Statistic].[TotalBlackBoxVulnerabilityCount],
	[a_Statistic].[TotalStaticVulnerabilityCount],
	[a_Statistic].[TotalVulnerabilityCount],
	[a_Statistic].[TotalFileCount],
	[a_Statistic].[TotalUrlCount],
	[a_Statistic].[ScannedUrlCount],
	[a_Statistic].[ScannedFileCount],
	[a_ScanEnvironment].[ScanResultId],
	[a_ScanEnvironment].[InfrastructureVersionId],
	[a_ScanEnvironment].[InstallatorVersionId],
	[a_ScanEnvironment].[ClientVersionId],
	[a_ScanEnvironment].[PmHash],
	[a_ScanEnvironment].[FullRescanOnNewFilesAdded],
	[a_InfrastructureVersion].[Id],
	[a_InfrastructureVersion].[Type],
	[a_InfrastructureVersion].[Version],
	[a_InstallatorVersion].[Id],
	[a_InstallatorVersion].[Type],
	[a_InstallatorVersion].[Version],
	[a_ClientVersion].[Id],
	[a_ClientVersion].[Type],
	[a_ClientVersion].[Version]
FROM
	[ScanResultEntity] [x]
		LEFT JOIN [ScanResultProgressEntity] [a_Progress] ON [x].[Id] = [a_Progress].[ScanResultId]
		LEFT JOIN [ScanResultStatisticEntity] [a_Statistic] ON [x].[Id] = [a_Statistic].[ScanResultId]
		LEFT JOIN [ScanEnvironmentEntity] [a_ScanEnvironment] ON [x].[Id] = [a_ScanEnvironment].[ScanResultId]
		LEFT JOIN [ComponentVersionEntity] [a_ClientVersion] ON [a_ScanEnvironment].[ClientVersionId] = [a_ClientVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InstallatorVersion] ON [a_ScanEnvironment].[InstallatorVersionId] = [a_InstallatorVersion].[Id]
		LEFT JOIN [ComponentVersionEntity] [a_InfrastructureVersion] ON [a_ScanEnvironment].[InfrastructureVersionId] = [a_InfrastructureVersion].[Id]
WHERE
	[x].[Id] = @id
LIMIT @take

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002503

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004302. Rows Count: 1.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Stage  -- Int32
SET     @Stage = 4
DECLARE @SubStage NVarChar -- String
SET     @SubStage = NULL
DECLARE @Value  -- Int32
SET     @Value = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultProgressEntity]
SET
	[Stage] = @Stage,
	[SubStage] = @SubStage,
	[Value] = @Value
WHERE
	[ScanResultProgressEntity].[ScanResultId] = @ScanResultId

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0005458. Records Affected: 1.

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0006933. Rows Count: 0.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @State  -- Int64
SET     @State = 0
DECLARE @PolicyState  -- Int32
SET     @PolicyState = 0
DECLARE @ScanDurationRaw NVarChar(16) -- String
SET     @ScanDurationRaw = '00:00:03.0091233'
DECLARE @HighLevelVulnerabilityCount  -- Int32
SET     @HighLevelVulnerabilityCount = 0
DECLARE @MediumLevelVulnerabilityCount  -- Int32
SET     @MediumLevelVulnerabilityCount = 0
DECLARE @LowLevelVulnerabilityCount  -- Int32
SET     @LowLevelVulnerabilityCount = 0
DECLARE @PotentialVulnerabilityCount  -- Int32
SET     @PotentialVulnerabilityCount = 0
DECLARE @TotalBlackBoxVulnerabilityCount  -- Int32
SET     @TotalBlackBoxVulnerabilityCount = 0
DECLARE @TotalStaticVulnerabilityCount  -- Int32
SET     @TotalStaticVulnerabilityCount = 0
DECLARE @TotalVulnerabilityCount  -- Int32
SET     @TotalVulnerabilityCount = 0
DECLARE @TotalFileCount  -- Int32
SET     @TotalFileCount = 5
DECLARE @TotalUrlCount  -- Int32
SET     @TotalUrlCount = 0
DECLARE @ScannedUrlCount  -- Int32
SET     @ScannedUrlCount = 0
DECLARE @ScannedFileCount  -- Int32
SET     @ScannedFileCount = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultStatisticEntity]
SET
	[State] = @State,
	[PolicyState] = @PolicyState,
	[ScanDurationRaw] = @ScanDurationRaw,
	[HighLevelVulnerabilityCount] = @HighLevelVulnerabilityCount,
	[MediumLevelVulnerabilityCount] = @MediumLevelVulnerabilityCount,
	[LowLevelVulnerabilityCount] = @LowLevelVulnerabilityCount,
	[PotentialVulnerabilityCount] = @PotentialVulnerabilityCount,
	[TotalBlackBoxVulnerabilityCount] = @TotalBlackBoxVulnerabilityCount,
	[TotalStaticVulnerabilityCount] = @TotalStaticVulnerabilityCount,
	[TotalVulnerabilityCount] = @TotalVulnerabilityCount,
	[TotalFileCount] = @TotalFileCount,
	[TotalUrlCount] = @TotalUrlCount,
	[ScannedUrlCount] = @ScannedUrlCount,
	[ScannedFileCount] = @ScannedFileCount
WHERE
	[ScanResultStatisticEntity].[ScanResultId] = @ScanResultId

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001960. Records Affected: 1.

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003410. Rows Count: 0.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ScanChainId  -- Guid
SET     @ScanChainId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ProjectId  -- Guid
SET     @ProjectId = X'9A766956FE8C964A811D536887BDEBDE'
DECLARE @SettingsId  -- Guid
SET     @SettingsId = X'E88D42B9E97F7441919C160282304B64'
DECLARE @Version  -- Int32
SET     @Version = 1
DECLARE @ScanDate  -- DateTime
SET     @ScanDate = '2024-11-20 08:42:24.292'
DECLARE @PreviousScanResultId  -- Guid
SET     @PreviousScanResultId = NULL
DECLARE @IsRunFromQueue  -- Boolean
SET     @IsRunFromQueue = 0
DECLARE @Id  -- Guid
SET     @Id = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanResultEntity]
SET
	[ScanChainId] = @ScanChainId,
	[ProjectId] = @ProjectId,
	[SettingsId] = @SettingsId,
	[Version] = @Version,
	[ScanDate] = @ScanDate,
	[PreviousScanResultId] = @PreviousScanResultId,
	[IsRunFromQueue] = @IsRunFromQueue
WHERE
	[ScanResultEntity].[Id] = @Id

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0004207. Records Affected: 1.

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0005938. Rows Count: 0.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'553AE2D9D0954F4897CB4452C854D793'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0003388. Records Affected: 1.

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004788. Rows Count: 0.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'246F1FE00ECD7B419C74D57CDEC0942B'
DECLARE @Type NVarChar(14) -- String
SET     @Type = 'Infrastructure'
DECLARE @Version NVarChar(7) -- String
SET     @Version = '2.3.1.0'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001594. Records Affected: 1.

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002945. Rows Count: 0.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'0EF48F1A772D644FA0C1F3AD37FC0BF6'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002572. Records Affected: 1.

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003917. Rows Count: 0.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'0EF48F1A772D644FA0C1F3AD37FC0BF6'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001864. Records Affected: 1.

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003240. Rows Count: 0.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'19DD136CCCBBDF4BBD724725E90A62E8'

DELETE FROM
	[ScanEnvironmentComponentVersionsEntity]
WHERE
	[ScanEnvironmentComponentVersionsEntity].[ComponentVersionId] = @ComponentVersionId

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001459. Records Affected: 1.

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002757. Rows Count: 0.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'19DD136CCCBBDF4BBD724725E90A62E8'

DELETE FROM
	[ComponentVersionEntity]
WHERE
	[ComponentVersionEntity].[Id] = @Id

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002724. Records Affected: 1.

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004805. Rows Count: 0.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'093988C62366EF43A4F1AEFBA4B1011F'
DECLARE @Type NVarChar(29) -- String
SET     @Type = 'AI.INFRASTRUCTURE.INSTALLATOR'
DECLARE @Version NVarChar(11) -- String
SET     @Version = '2.3.1.42013'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001605. Records Affected: 1.

14:42:29.594  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002959. Rows Count: 0.

14:42:29.594  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'093988C62366EF43A4F1AEFBA4B1011F'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:29.594  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001873. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003233. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'1DEB4585AA45AE4D9EF47401018AA802'
DECLARE @Type NVarChar(18) -- String
SET     @Type = 'AI.Plugin.Analyzer'
DECLARE @Version NVarChar(19) -- String
SET     @Version = '2.3.1.42013-win-x64'

INSERT INTO [ComponentVersionEntity]
(
	[Id],
	[Type],
	[Version]
)
VALUES
(
	@Id,
	@Type,
	@Version
)

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001539. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003192. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @ComponentVersionId  -- Guid
SET     @ComponentVersionId = X'1DEB4585AA45AE4D9EF47401018AA802'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'

INSERT INTO [ScanEnvironmentComponentVersionsEntity]
(
	[ComponentVersionId],
	[ScanEnvironmentId]
)
VALUES
(
	@ComponentVersionId,
	@ScanEnvironmentId
)

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001544. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002909. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4496E845B29C2242BAA3B2E2646972E8'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002496. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003883. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'DA59076600EE42449B8A1D67149FAFDD'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001378. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002638. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'4FC4F4DA9308D041B75C620FFD4EF6FE'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001406. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002649. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'ADF612A743423645ADD47C579ABFFC3C'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001343. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002572. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'0742F2DC76AE6942A15760D6AD863962'

DELETE FROM
	[SastHashesEntity]
WHERE
	[SastHashesEntity].[Id] = @Id

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001334. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002562. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'ADFC6A49F32D794DBBC901793C705EC0'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 32
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001962. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0003327. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'C09B0CA5581BDF428E673D924AE35D8F'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 8
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001436. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002702. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'FFF66121AE2668449C83C6365AC52DF7'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 16
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001418. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002646. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'72CDB3D513F03D4AA60CDF753B71C3AD'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 4096
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001432. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002661. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @Id  -- Guid
SET     @Id = X'0B786E9A6AA20F49B2701757A6ABA531'
DECLARE @ScanEnvironmentId  -- Guid
SET     @ScanEnvironmentId = X'DDFEE4D07B1354498931B0547328C62E'
DECLARE @ScanAppType  -- UInt16
SET     @ScanAppType = 64
DECLARE @Hash Binary
SET     @Hash = NULL

INSERT INTO [SastHashesEntity]
(
	[Id],
	[ScanEnvironmentId],
	[ScanAppType],
	[Hash]
)
VALUES
(
	@Id,
	@ScanEnvironmentId,
	@ScanAppType,
	@Hash
)

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0001417. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0002643. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
--  SQLite.MS SQLite (asynchronously)
DECLARE @InfrastructureVersionId  -- Guid
SET     @InfrastructureVersionId = X'246F1FE00ECD7B419C74D57CDEC0942B'
DECLARE @InstallatorVersionId  -- Guid
SET     @InstallatorVersionId = NULL
DECLARE @ClientVersionId  -- Guid
SET     @ClientVersionId = NULL
DECLARE @PmHash Binary
SET     @PmHash = NULL
DECLARE @FullRescanOnNewFilesAdded  -- Boolean
SET     @FullRescanOnNewFilesAdded = 0
DECLARE @ScanResultId  -- Guid
SET     @ScanResultId = X'DDFEE4D07B1354498931B0547328C62E'

UPDATE
	[ScanEnvironmentEntity]
SET
	[InfrastructureVersionId] = @InfrastructureVersionId,
	[InstallatorVersionId] = @InstallatorVersionId,
	[ClientVersionId] = @ClientVersionId,
	[PmHash] = @PmHash,
	[FullRescanOnNewFilesAdded] = @FullRescanOnNewFilesAdded
WHERE
	[ScanEnvironmentEntity].[ScanResultId] = @ScanResultId

14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0002061. Records Affected: 1.

14:42:29.602  TRACE  Total Execution Time (Completed) (async): 00:00:00.0004359. Rows Count: 0.

14:42:29.602  TRACE  BeforeExecute
CommitTransactionAsync
14:42:29.602  TRACE  Query Execution Time (AfterExecute) (async): 00:00:00.0073649

